<?xml version="1.0" standalone="no"?>
<monkeyml version="1.0">
    <io_devices tag="IO Devices">
        <iodevice tag="dummy" priority="" type="dummy" id="" alt=""></iodevice>
        <iodevice type="phidget" tag="phidget" alt="dummy" priority="" id="">
            <iochannel type="phidget" tag="channel1" variable="LickInput1" index="5" capability="analog_input"></iochannel>
            <iochannel type="phidget" tag="channel2" variable="LickInput2" index="6" capability="analog_input"></iochannel>
            <iochannel type="phidget" tag="channel3" variable="LickInput3" index="7" capability="analog_input"></iochannel>
        </iodevice>
        <iodevice type="NE500" tag="NE500" alt="dummy" address="#serialBridgeAddress" port="100" priority="" id="">
            <iochannel type="NE500" tag="pump1" variable="LickOutput1" capability="01" flow_rate="100" syringe_diameter="15.0"></iochannel>
            <iochannel type="NE500" tag="pump2" variable="LickOutput3" capability="02" flow_rate="100" syringe_diameter="15.0"></iochannel>
        </iodevice>
    </io_devices>
    <variables tag="Variables">
        <folder tag="Bias Monitor">
            <variable tag="Adjusted_Metric_Correct_Strategy" full_name="" default_value="1.0" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="BiasMonitor" default="0"></variable>
            <variable tag="GainFactorCorrectMetric" full_name="" default_value="1.5" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="BiasMonitor" default="1.5"></variable>
            <variable default_value="0" editable="ALWAYS" full_name="considered success in the stair case" logging="WHEN_CHANGED" scope="GLOBAL" tag="FlagAutomaticBiasSuppression" type="INTEGER" persistant="YES" groups="BiasMonitor" default="0"></variable>
            <variable default_value="0" editable="ALWAYS" full_name="considered success in the stair case" logging="WHEN_CHANGED" scope="GLOBAL" tag="WatchResponseSide" type="INTEGER" persistant="YES" groups="BiasMonitor"></variable>
            <variable default_value="0" editable="ALWAYS" full_name="considered success in the stair case" logging="WHEN_CHANGED" scope="GLOBAL" tag="WatchSuccessBias" type="INTEGER" persistant="YES" groups="BiasMonitor"></variable>
            <variable tag="Metric_Correct_Strategy" full_name="" default_value="1.0" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="BiasMonitor" default="0"></variable>
            <variable tag="Metric_Biased_Strategy" full_name="" default_value="1.0" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="BiasMonitor" default="0"></variable>
            <variable tag="Metric_Alternation_Strategy" full_name="" default_value="1.0" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="BiasMonitor" default="0"></variable>
        </folder>
        <folder tag="Staircase Horizontal Stimulus Separation">
            <variable tag="FlagStaircaseHorizSeparation" full_name="" default_value="1" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_GENERAL, StairCase_HORIZ_SEP"></variable>
            <variable default_value="0" editable="ALWAYS" full_name="considered success in the stair case" logging="WHEN_CHANGED" scope="GLOBAL" tag="WatchSuccessStair_HorizSep" type="INTEGER" persistant="YES" groups="StairCase_HORIZ_SEP"></variable>
            <variable tag="HorizSep_stair_up_criterion" full_name="% correect required to go up" default_value="0.7" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_HORIZ_SEP"></variable>
            <variable tag="HorizSep_stair_down_criterion" full_name="% failed required to go down" default_value="0.5" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_HORIZ_SEP"></variable>
            <variable tag="deg_HorizSep_current" full_name="" default_value="7.5" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_HORIZ_SEP"></variable>
            <variable tag="deg_HorizSep_upper_limit" full_name="" default_value="7.5" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_HORIZ_SEP"></variable>
            <variable tag="deg_HorizSep_lower_limit" full_name="" default_value="0" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_HORIZ_SEP"></variable>
            <variable tag="deg_HorizSep_stair_step" full_name="" default_value="-2.5" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_HORIZ_SEP"></variable>
        </folder>
        <variable default_value="1" editable="ALWAYS" full_name="y" logging="WHEN_CHANGED" scope="GLOBAL" tag="y" type="INTEGER" persistant="NO"></variable>
        <folder tag="Staircase probability free reward">
            <variable tag="FlagStaircaseProbFreeRew" full_name="" default_value="1" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_GENERAL, StairCase_FREE_REW"></variable>
            <variable default_value="0" editable="ALWAYS" full_name="considered success in the stair case" logging="WHEN_CHANGED" scope="GLOBAL" tag="WatchSuccessStair_FreeRew" type="INTEGER" persistant="YES" groups="StairCase_FREE_REW"></variable>
            <variable tag="FreeRew_stair_up_criterion" full_name="% correect required to go up" default_value="0.7" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_FREE_REW"></variable>
            <variable tag="FreeRew_stair_down_criterion" full_name="% failed required to go down" default_value="0.5" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_FREE_REW"></variable>
            <variable tag="FreeRew_CurrRandSamp" full_name="" default_value="1.0" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_FREE_REW"></variable>
            <variable tag="p_FreeRew_current" full_name="" default_value="1.0" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_FREE_REW"></variable>
            <variable tag="p_FreeRew_upper_limit" full_name="" default_value="1.0" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_FREE_REW"></variable>
            <variable tag="p_FreeRew_lower_limit" full_name="" default_value="0.0" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_FREE_REW"></variable>
            <variable tag="p_FreeRew_stair_step" full_name="" default_value="-0.2" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_FREE_REW"></variable>
        </folder>
        <folder tag="Transformations Test Variables">
            <variable tag="reject_size1" full_name="rotation to reject" default_value="25" scope="GLOBAL" type="FLOAT" editable="never" logging="when_changed" persistant="NO"></variable>
            <variable tag="reject_size2" full_name="rotation to reject" default_value="35" scope="GLOBAL" type="FLOAT" editable="never" logging="when_changed" persistant="NO"></variable>
            <variable tag="reject_size3" full_name="rotation to reject" default_value="35" scope="GLOBAL" type="FLOAT" editable="never" logging="when_changed" persistant="NO"></variable>
            <variable tag="reject_size4" full_name="rotation to reject" default_value="25" scope="GLOBAL" type="FLOAT" editable="never" logging="when_changed" persistant="NO"></variable>
            <variable tag="reject_size5" full_name="rotation to reject" default_value="30" scope="GLOBAL" type="FLOAT" editable="never" logging="when_changed" persistant="NO"></variable>
            <variable tag="reject_rot1" full_name="rotation to reject" default_value="-30" scope="GLOBAL" type="FLOAT" editable="never" logging="when_changed" persistant="NO"></variable>
            <variable tag="reject_rot2" full_name="rotation to reject" default_value="15" scope="GLOBAL" type="FLOAT" editable="never" logging="when_changed" persistant="NO"></variable>
            <variable tag="reject_rot3" full_name="rotation to reject" default_value="-15" scope="GLOBAL" type="FLOAT" editable="never" logging="when_changed" persistant="NO"></variable>
            <variable tag="reject_rot4" full_name="rotation to reject" default_value="0" scope="GLOBAL" type="FLOAT" editable="never" logging="when_changed" persistant="NO"></variable>
            <variable tag="reject_rot5" full_name="rotation to reject" default_value="-30" scope="GLOBAL" type="FLOAT" editable="never" logging="when_changed" persistant="NO"></variable>
            <variable tag="reject_pos_x1" full_name="position to reject" default_value="-10" scope="GLOBAL" type="FLOAT" editable="never" logging="when_changed" persistant="NO"></variable>
            <variable tag="reject_pos_x2" full_name="position to reject" default_value="-10" scope="GLOBAL" type="FLOAT" editable="never" logging="when_changed" persistant="NO"></variable>
            <variable tag="reject_pos_x3" full_name="position to reject" default_value="0" scope="GLOBAL" type="FLOAT" editable="never" logging="when_changed" persistant="NO"></variable>
            <variable tag="reject_pos_x4" full_name="position to reject" default_value="5" scope="GLOBAL" type="FLOAT" editable="never" logging="when_changed" persistant="NO"></variable>
            <variable tag="reject_pos_x5" full_name="position to reject" default_value="10" scope="GLOBAL" type="FLOAT" editable="never" logging="when_changed" persistant="NO"></variable>
            <variable default_value="0" editable="ALWAYS" full_name="" logging="WHEN_CHANGED" scope="GLOBAL" tag="FlagNoFeedbackInCurrentTrial" type="INTEGER" persistant="YES"></variable>
            <variable tag="Test_Size" full_name="stimulus size" default_value="35" scope="LOCAL" type="FLOAT" editable="never" logging="when_changed" persistant="YES"></variable>
            <variable tag="Test_X_Position" full_name="stimulus size" default_value="-10" scope="LOCAL" type="FLOAT" editable="never" logging="when_changed" persistant="YES"></variable>
            <variable tag="Test_Rotation" full_name="stimulus size" default_value="-30" scope="LOCAL" type="FLOAT" editable="never" logging="when_changed" persistant="YES"></variable>
        </folder>
        <folder tag="Announcements">
            <variable tag="Announce_TrialNoFeedback" full_name="start of actual behavioral trials, after the animal trigger port 2" default_value="0" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="Announce_TrialStart" full_name="start of actual behavioral trials, after the animal trigger port 2" default_value="0" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="Announce_TrialEnd" full_name="end of a behavioral trial just before the task system goes in the finish state" default_value="0" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="Announce_StimOn" full_name="signal stim is on before updating the screen" default_value="0" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="Announce_StimOff" full_name="signal stim is off after refreshing display" default_value="0" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="Announce_AcquirePort1" full_name="after animal trigger port 1" default_value="0" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="Announce_AcquirePort3" full_name="after animal trigger port 3" default_value="0" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
        </folder>
        <folder tag="Staircase general">
            <variable tag="Flag_two_third_trials_Rotation" full_name="if it is 1, two thirds of the trials belong to the rotation staircase" default_value="0" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="FlagSampUniformDistr" full_name="smaple in the staircase from a unifrom distribution" default_value="0" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_GENERAL"></variable>
            <variable tag="FlagStaircaseSize" full_name="if it is zero the staircase is freezed" default_value="1" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_GENERAL, StairCase_SIZE"></variable>
            <variable tag="FlagStaircasePosHR" full_name="if it is zero the staircase is freezed" default_value="0" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_GENERAL, StairCase_POS_HR"></variable>
            <variable tag="FlagStaircasePosHL" full_name="if it is zero the staircase is freezed" default_value="0" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_GENERAL, StairCase_POS_HL"></variable>
            <variable tag="FlagStaircasePosVU" full_name="if it is zero the staircase is freezed" default_value="0" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_GENERAL"></variable>
            <variable tag="FlagStaircasePosVD" full_name="if it is zero the staircase is freezed" default_value="0" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_GENERAL"></variable>
            <variable tag="FlagStaircaseRotCW" full_name="if it is zero the staircase is freezed" default_value="0" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_GENERAL"></variable>
            <variable tag="FlagStaircaseRotACW" full_name="if it is zero the staircase is freezed" default_value="0" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_GENERAL"></variable>
            <variable tag="Default_size" full_name="default" default_value="20" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="Default_size_for_StairRotation" full_name="default" default_value="30" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="Default_PosH" full_name="default" default_value="0" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="Default_PosV" full_name="default" default_value="0" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="Default_Rotation" full_name="default" default_value="0.0" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="CurrStairTrial" full_name="Current staircase trial type" default_value="2" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="CurrThird" full_name="Used if Flag_two_third_trials_Rotation is 1" default_value="0" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="Flag_MatchCurrStairTrial" full_name="tell if the current trial type matches the current staircase trial type" default_value="0" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="N_Staircases" full_name="Total number of staircases (active or not)" default_value="7" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
        </folder>
        <folder tag="Staircase Parameters Stim Size">
            <variable default_value="0.2" editable="ALWAYS" full_name="Bernoulli prob in the geometric distribution" logging="WHEN_CHANGED" scope="GLOBAL" tag="p_GeomDistr_stair_size" type="DOUBLE" persistant="YES" groups="StairCase_SIZE"></variable>
            <variable default_value="0" editable="ALWAYS" full_name="considered success in the stair case" logging="WHEN_CHANGED" scope="GLOBAL" tag="WatchSuccessStair_size" type="INTEGER" persistant="YES" groups="StairCase_SIZE"></variable>
            <variable tag="size_stair_up_criterion" full_name="% correect required to go up" default_value="0.7" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_SIZE"></variable>
            <variable tag="size_stair_down_criterion" full_name="% failed required to go down" default_value="0.5" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_SIZE"></variable>
            <variable tag="initial_size_stair" full_name="starting value of stimulus size" default_value="40" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_SIZE"></variable>
            <variable tag="current_size_limit_stair" full_name="current limit of the allowed range of stimulus sizes" default_value="40" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_SIZE"></variable>
            <variable tag="size_stair_step" full_name="size bins in the allowed size range" default_value="-2.5" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_SIZE"></variable>
            <variable tag="N_sizes_stair_upper_limit" full_name="maximal number of sizes in the allowed size range" default_value="15" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_SIZE"></variable>
            <variable tag="N_sizes_stair_current" full_name="current number of sizes in the allowed size range" default_value="0" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_SIZE"></variable>
        </folder>
        <folder tag="Staircase Parameters Stim Pos HR">
            <variable default_value="0.2" editable="ALWAYS" full_name="Bernoulli prob in the geometric distribution" logging="WHEN_CHANGED" scope="GLOBAL" tag="p_GeomDistr_stair_PosHR" type="DOUBLE" persistant="YES" groups="StairCase_POS_HR"></variable>
            <variable default_value="0" editable="ALWAYS" full_name="considered success in the stair case" logging="WHEN_CHANGED" scope="GLOBAL" tag="WatchSuccessStair_PosHR" type="INTEGER" persistant="YES" groups="StairCase_POS_HR"></variable>
            <variable tag="PosHR_stair_up_criterion" full_name="% correect required to go up" default_value="0.7" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_POS_HR"></variable>
            <variable tag="PosHR_stair_down_criterion" full_name="% failed required to go down" default_value="0.5" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_POS_HR"></variable>
            <variable tag="initial_PosHR_stair" full_name="starting value of stimulus size" default_value="0" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_POS_HR"></variable>
            <variable tag="current_PosHR_limit_stair" full_name="current limit of the allowed range of stimulus sizes" default_value="0" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_POS_HR"></variable>
            <variable tag="PosHR_stair_step" full_name="size bins in the allowed size range" default_value="2.5" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_POS_HR"></variable>
            <variable tag="N_PosHR_stair_upper_limit" full_name="maximal number of sizes in the allowed size range" default_value="12" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_POS_HR"></variable>
            <variable tag="N_PosHR_stair_current" full_name="current number of sizes in the allowed size range" default_value="6" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_POS_HR"></variable>
        </folder>
        <folder tag="Staircase Parameters Stim Pos HL">
            <variable default_value="0.2" editable="ALWAYS" full_name="Bernoulli prob in the geometric distribution" logging="WHEN_CHANGED" scope="GLOBAL" tag="p_GeomDistr_stair_PosHL" type="DOUBLE" persistant="YES" groups="StairCase_POS_HL"></variable>
            <variable default_value="0" editable="ALWAYS" full_name="considered success in the stair case" logging="WHEN_CHANGED" scope="GLOBAL" tag="WatchSuccessStair_PosHL" type="INTEGER" persistant="YES" groups="StairCase_POS_HL"></variable>
            <variable tag="PosHL_stair_up_criterion" full_name="% correect required to go up" default_value="0.7" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_POS_HL"></variable>
            <variable tag="PosHL_stair_down_criterion" full_name="% failed required to go down" default_value="0.5" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_POS_HL"></variable>
            <variable tag="initial_PosHL_stair" full_name="starting value of stimulus size" default_value="0" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_POS_HL"></variable>
            <variable tag="current_PosHL_limit_stair" full_name="current limit of the allowed range of stimulus sizes" default_value="0" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_POS_HL"></variable>
            <variable tag="PosHL_stair_step" full_name="size bins in the allowed size range" default_value="-2.5" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_POS_HL"></variable>
            <variable tag="N_PosHL_stair_upper_limit" full_name="maximal number of sizes in the allowed size range" default_value="12" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_POS_HL"></variable>
            <variable tag="N_PosHL_stair_current" full_name="current number of sizes in the allowed size range" default_value="6" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="StairCase_POS_HL"></variable>
        </folder>
        <folder tag="Staircase Parameters Stim Pos VU">
            <variable default_value="0.2" editable="ALWAYS" full_name="Bernoulli prob in the geometric distribution" logging="WHEN_CHANGED" scope="GLOBAL" tag="p_GeomDistr_stair_PosVU" type="DOUBLE" persistant="YES"></variable>
            <variable default_value="0" editable="ALWAYS" full_name="considered success in the stair case" logging="WHEN_CHANGED" scope="GLOBAL" tag="WatchSuccessStair_PosVU" type="INTEGER" persistant="YES"></variable>
            <variable tag="PosVU_stair_up_criterion" full_name="% correect required to go up" default_value="0.7" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="PosVU_stair_down_criterion" full_name="% failed required to go down" default_value="0.5" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="initial_PosVU_stair" full_name="starting value of stimulus size" default_value="0" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="current_PosVU_limit_stair" full_name="current limit of the allowed range of stimulus sizes" default_value="0" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="PosVU_stair_step" full_name="size bins in the allowed size range" default_value="2.5" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="N_PosVU_stair_upper_limit" full_name="maximal number of sizes in the allowed size range" default_value="12" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="N_PosVU_stair_current" full_name="current number of sizes in the allowed size range" default_value="0" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
        </folder>
        <folder tag="Staircase Parameters Stim Pos VD">
            <variable default_value="0.2" editable="ALWAYS" full_name="Bernoulli prob in the geometric distribution" logging="WHEN_CHANGED" scope="GLOBAL" tag="p_GeomDistr_stair_PosVD" type="DOUBLE" persistant="YES"></variable>
            <variable default_value="0" editable="ALWAYS" full_name="considered success in the stair case" logging="WHEN_CHANGED" scope="GLOBAL" tag="WatchSuccessStair_PosVD" type="INTEGER" persistant="YES"></variable>
            <variable tag="PosVD_stair_up_criterion" full_name="% correect required to go up" default_value="0.7" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="PosVD_stair_down_criterion" full_name="% failed required to go down" default_value="0.5" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="initial_PosVD_stair" full_name="starting value of stimulus size" default_value="0" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="current_PosVD_limit_stair" full_name="current limit of the allowed range of stimulus sizes" default_value="0" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="PosVD_stair_step" full_name="size bins in the allowed size range" default_value="-2.5" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="N_PosVD_stair_upper_limit" full_name="maximal number of sizes in the allowed size range" default_value="12" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="N_PosVD_stair_current" full_name="current number of sizes in the allowed size range" default_value="0" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
        </folder>
        <folder tag="Staircase Parameters Stim Rot CW">
            <variable default_value="0.4" editable="ALWAYS" full_name="Bernoulli prob in the geometric distribution" logging="WHEN_CHANGED" scope="GLOBAL" tag="p_GeomDistr_stair_RotCW" type="DOUBLE" persistant="YES"></variable>
            <variable default_value="0" editable="ALWAYS" full_name="considered success in the stair case" logging="WHEN_CHANGED" scope="GLOBAL" tag="WatchSuccessStair_RotCW" type="INTEGER" persistant="YES"></variable>
            <variable tag="RotCW_stair_up_criterion" full_name="% correect required to go up" default_value="0.7" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="RotCW_stair_down_criterion" full_name="% failed required to go down" default_value="0.5" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="initial_RotCW_stair" full_name="starting value of stimulus size" default_value="0" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="current_RotCW_limit_stair" full_name="current limit of the allowed range of stimulus sizes" default_value="0" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="RotCW_stair_step" full_name="size bins in the allowed size range" default_value="-5" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="N_RotCW_stair_upper_limit" full_name="maximal number of sizes in the allowed size range" default_value="12" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="N_RotCW_stair_current" full_name="current number of sizes in the allowed size range" default_value="0" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
        </folder>
        <folder tag="Staircase Parameters Stim Rot ACW">
            <variable default_value="0.4" editable="ALWAYS" full_name="Bernoulli prob in the geometric distribution" logging="WHEN_CHANGED" scope="GLOBAL" tag="p_GeomDistr_stair_RotACW" type="DOUBLE" persistant="YES"></variable>
            <variable default_value="0" editable="ALWAYS" full_name="considered success in the stair case" logging="WHEN_CHANGED" scope="GLOBAL" tag="WatchSuccessStair_RotACW" type="INTEGER" persistant="YES"></variable>
            <variable tag="RotACW_stair_up_criterion" full_name="% correect required to go up" default_value="0.7" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="RotACW_stair_down_criterion" full_name="% failed required to go down" default_value="0.5" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="initial_RotACW_stair" full_name="starting value of stimulus size" default_value="0" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="current_RotACW_limit_stair" full_name="current limit of the allowed range of stimulus sizes" default_value="0" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="RotACW_stair_step" full_name="size bins in the allowed size range" default_value="5" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="N_RotACW_stair_upper_limit" full_name="maximal number of sizes in the allowed size range" default_value="12" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="N_RotACW_stair_current" full_name="current number of sizes in the allowed size range" default_value="0" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
        </folder>
        <folder tag="Behavioral Parameters">
            <variable default_value="1" editable="ALWAYS" full_name="Signal that the next will be a correction trial" logging="WHEN_CHANGED" scope="GLOBAL" tag="FlagPlayOutcomeSound" type="INTEGER" persistant="YES" groups="Sounds"></variable>
            <variable default_value="0" editable="ALWAYS" full_name="Index of current punishment cycle" logging="WHEN_CHANGED" scope="GLOBAL" tag="PunishmentCyclesIndex" type="INTEGER" persistant="YES"></variable>
            <variable default_value="0" editable="ALWAYS" full_name="success" logging="WHEN_CHANGED" scope="GLOBAL" tag="success" type="INTEGER" persistant="YES"></variable>
            <variable default_value="0" editable="ALWAYS" full_name="failure" logging="WHEN_CHANGED" scope="GLOBAL" tag="failure" type="INTEGER" persistant="YES"></variable>
            <variable default_value="0" editable="ALWAYS" full_name="ignore" logging="WHEN_CHANGED" scope="GLOBAL" tag="ignore" type="INTEGER" persistant="YES"></variable>
            <variable default_value="100 ms" editable="ALWAYS" full_name="period of flickering of the background for punishment" logging="WHEN_CHANGED" scope="GLOBAL" tag="backgr_punish_flickering_period" type="INTEGER" persistant="YES" groups="Punishment"></variable>
            <variable tag="Backgr_GrayLevel" full_name="gray level of background during punishment" default_value="0.4" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES" groups="Punishment"></variable>
            <variable default_value="15" editable="ALWAYS" full_name="Number of current punishment cycle" logging="WHEN_CHANGED" scope="GLOBAL" tag="N_PunishmentCycles" type="INTEGER" persistant="YES" groups="Punishment"></variable>
            <variable default_value="1" editable="ALWAYS" full_name="Severly punish failure" logging="WHEN_CHANGED" scope="GLOBAL" tag="FlagLongPunishment" type="INTEGER" persistant="YES" groups="Punishment"></variable>
            <variable default_value="0" editable="ALWAYS" full_name="Repeat last trial if failed" logging="WHEN_CHANGED" scope="GLOBAL" tag="FlagCorrectionTrials" type="INTEGER" persistant="YES" groups="Training_Strategies"></variable>
            <variable default_value="0" editable="ALWAYS" full_name="Signal that the next will be a correction trial" logging="WHEN_CHANGED" scope="GLOBAL" tag="FlagRepeatedTrial" type="INTEGER" persistant="YES"></variable>
            <variable default_value="0" editable="ALWAYS" full_name="Always give reward after stimulus is presented" logging="WHEN_CHANGED" scope="GLOBAL" tag="FlagAlwaysReward" type="INTEGER" persistant="YES" groups="Reward, Training_Strategies, StairCase_FREE_REW"></variable>
            <variable default_value="0" editable="ALWAYS" full_name="when this flag is on the free reward is not given (instead the amount of free reward is added to the earned reward)" logging="WHEN_CHANGED" scope="GLOBAL" tag="FlagAddFreeRewardToEarnedReward" type="INTEGER" persistant="YES" groups="Reward, Training_Strategies, StairCase_FREE_REW"></variable>
        </folder>
        <folder tag="Stimulus Parameters">
            <variable default_value="1" editable="ALWAYS" full_name="" logging="WHEN_CHANGED" scope="GLOBAL" tag="FlagAlwaysEnforceMaxSeqLeng" type="INTEGER" persistant="YES" groups="Training_Strategies"></variable>
            <variable default_value="1" editable="ALWAYS" full_name="" logging="WHEN_CHANGED" scope="GLOBAL" tag="FlagDiscardCurrStim" type="INTEGER" persistant="YES" groups="Training_Strategies"></variable>
            <variable tag="StimAspectRatio" full_name="stimulus aspect ratio" default_value="1.747" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="when_changed" persistant="YES" groups="Stimulus_Properties"></variable>
            <variable default_value="1" editable="ALWAYS" full_name="if 0 no stimulio are presented" logging="WHEN_CHANGED" scope="GLOBAL" tag="FlagShowVisualStimuli" type="INTEGER" persistant="YES" groups="Training_Strategies"></variable>
            <variable default_value="0" editable="ALWAYS" full_name="Cue stim presentation with a reinforcement sound" logging="WHEN_CHANGED" scope="GLOBAL" tag="FlagCueStimSound" type="INTEGER" persistant="YES" groups="Sounds, Training_Strategies"></variable>
            <variable default_value="1" editable="ALWAYS" full_name="Allow stim pres on RIght side of screen" logging="WHEN_CHANGED" scope="GLOBAL" tag="FlagShowStimRight" type="INTEGER" persistant="YES" groups="Training_Strategies"></variable>
            <variable default_value="1" editable="ALWAYS" full_name="Allow stim pres on Left side of screen" logging="WHEN_CHANGED" scope="GLOBAL" tag="FlagShowStimLeft" type="INTEGER" persistant="YES" groups="Training_Strategies"></variable>
            <variable default_value="4" editable="ALWAYS" full_name="Maximal number of stimuli with the same identity in a row" logging="WHEN_CHANGED" scope="GLOBAL" tag="MaxN_IdenticalStims" type="INTEGER" persistant="YES" groups="Training_Strategies"></variable>
            <variable default_value="0" editable="ALWAYS" full_name="Count how many right stims presented so far" logging="WHEN_CHANGED" scope="GLOBAL" tag="RightStim_Counter" type="INTEGER" persistant="NO"></variable>
            <variable default_value="0" editable="ALWAYS" full_name="Count how many left stims presented so far" logging="WHEN_CHANGED" scope="GLOBAL" tag="LeftStim_Counter" type="INTEGER" persistant="NO"></variable>
            <variable default_value="0" editable="ALWAYS" full_name="Count how many times in a row a stimulus type has been rejected" logging="WHEN_CHANGED" scope="GLOBAL" tag="StimRejections_Counter" type="INTEGER" persistant="NO"></variable>
            <variable default_value="10" editable="ALWAYS" full_name="Maximal number of stimuli with the same identity in a row" logging="WHEN_CHANGED" scope="GLOBAL" tag="MaxN_ConsecutiveRejections" type="INTEGER" persistant="YES"></variable>
            <variable default_value="1" editable="ALWAYS" full_name="Image Index" logging="WHEN_CHANGED" scope="LOCAL" tag="ImageIndex" type="INTEGER" persistant="YES"></variable>
            <variable tag="stm_pos_x" full_name="stm_pos_x" default_value="0" scope="GLOBAL" type="FLOAT" editable="never" logging="when_changed" persistant="NO" groups="Stimulus_Properties"></variable>
            <variable tag="stm_pos_y" full_name="stm_pos_y" default_value="0" scope="GLOBAL" type="FLOAT" editable="never" logging="when_changed" persistant="NO" groups="Stimulus_Properties"></variable>
            <variable tag="abs_stm_pos_x" full_name="Absolute x pos" default_value="0" scope="GLOBAL" type="FLOAT" editable="never" logging="when_changed" persistant="YES" groups="Stimulus_Properties"></variable>
            <variable tag="stm_size" full_name="stimulus size" default_value="40" scope="GLOBAL" type="FLOAT" editable="never" logging="when_changed" persistant="YES" groups="Stimulus_Properties"></variable>
            <variable tag="stm_rotation" full_name="stimulus rotation" default_value="0" scope="GLOBAL" type="FLOAT" editable="never" logging="when_changed" persistant="YES" groups="Stimulus_Properties"></variable>
            <variable default_value="3000 ms" editable="ALWAYS" full_name="Duration of stimulus presentation" logging="WHEN_CHANGED" scope="GLOBAL" tag="StimulusPresentation_time" type="INTEGER" persistant="YES" groups="Stimulus_Properties"></variable>
            <variable default_value="500 ms" editable="ALWAYS" full_name="Duration of sound to cue stim presentation" logging="WHEN_CHANGED" scope="GLOBAL" tag="CueStimSoundPresentation_time" type="INTEGER" persistant="YES" groups="Sounds"></variable>
        </folder>
        <folder tag="Timing Parameters">
            <variable default_value="0.02" editable="ALWAYS" full_name="Reward Duration" logging="WHEN_CHANGED" scope="GLOBAL" tag="curr_reward_duration" type="float" persistant="YES" groups="Reward"></variable>
            <variable default_value="1" editable="ALWAYS" full_name="Keep showing the stimulsu after the response" logging="WHEN_CHANGED" scope="GLOBAL" tag="FlagShowStimAfterResponse" type="INTEGER" persistant="YES"></variable>
            <variable default_value="50 ms" editable="ALWAYS" full_name="Response in this interval is too fast: trial must be aborted" logging="WHEN_CHANGED" scope="GLOBAL" tag="TooFast_time" type="INTEGER" persistant="YES" groups="Training_Strategies"></variable>
            <variable default_value="4000 ms" editable="ALWAYS" full_name="Aquire Time" logging="WHEN_CHANGED" scope="GLOBAL" tag="acquire_time" type="INTEGER" persistant="YES"></variable>
            <variable default_value="0.02" editable="ALWAYS" full_name="Reward Duration" logging="WHEN_CHANGED" scope="GLOBAL" tag="reward_duration" type="float" persistant="YES" groups="Reward"></variable>
            <variable default_value="0.02" editable="ALWAYS" full_name="Minimal Increment Reward Duration" logging="WHEN_CHANGED" scope="GLOBAL" tag="minimal_reward_duration" type="float" persistant="YES" groups="Reward"></variable>
            <variable default_value="0.02" editable="ALWAYS" full_name="Maximal Increment Reward Duration" logging="WHEN_CHANGED" scope="GLOBAL" tag="maximal_reward_duration" type="float" persistant="YES" groups="Reward"></variable>
            <variable default_value="0.001" editable="ALWAYS" full_name="Increment Reward Duration" logging="WHEN_CHANGED" scope="GLOBAL" tag="increment_reward_duration" type="float" persistant="YES" groups="Reward"></variable>
            <variable default_value="0.001" editable="ALWAYS" full_name="Cue Reward Duration" logging="WHEN_CHANGED" scope="GLOBAL" tag="cue_reward_duration" type="float" persistant="YES" groups="Reward"></variable>
            <variable default_value="4000 ms" editable="ALWAYS" full_name="Licking Time" logging="WHEN_CHANGED" scope="GLOBAL" tag="licking_time" type="INTEGER" persistant="YES"></variable>
            <variable default_value="1000 ms" editable="ALWAYS" full_name="Intertrial Interval" logging="WHEN_CHANGED" scope="GLOBAL" tag="intertrial_interval" type="INTEGER" persistant="YES"></variable>
            <variable tag="WaitForTrigger_time" full_name="fullname_2" default_value="5000ms" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable tag="CheckForBlockedTrialDuration" full_name="fullname_2" default_value="300 ms" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="YES"></variable>
            <variable default_value="500 ms" editable="ALWAYS" full_name="Block Trial Time" logging="WHEN_CHANGED" scope="GLOBAL" tag="BlockTrial_time" type="INTEGER" persistant="YES"></variable>
            <variable default_value="300 ms" editable="ALWAYS" full_name="Pre Stimulus Time" logging="WHEN_CHANGED" scope="GLOBAL" tag="prestim_time" type="INTEGER" persistant="YES"></variable>
            <variable default_value="500 ms" editable="ALWAYS" full_name="Block Trial Time" logging="WHEN_CHANGED" scope="GLOBAL" tag="WaitForTriggerToneDuration_time" type="INTEGER" persistant="YES"></variable>
        </folder>
        <folder tag="Lick Sensor 1">
            <variable default_value="1" editable="ALWAYS" full_name="Lick Sensor 1 Analog Value" logging="WHEN_CHANGED" scope="GLOBAL" tag="LickInput1" type="INTEGER" persistant="NO"></variable>
            <variable default_value="1" editable="ALWAYS" full_name="Lick Sensor 2 Analog Value" logging="WHEN_CHANGED" scope="GLOBAL" tag="LickInput2" type="INTEGER" persistant="NO"></variable>
            <variable default_value="1" editable="ALWAYS" full_name="Lick Sensor 3 Analog Value" logging="WHEN_CHANGED" scope="GLOBAL" tag="LickInput3" type="INTEGER" persistant="NO"></variable>
            <variable default_value="0" editable="ALWAYS" full_name="Reward Output 1 Time" logging="WHEN_CHANGED" scope="GLOBAL" tag="LickOutput1" type="INTEGER" persistant="NO"></variable>
            <variable default_value="0" editable="ALWAYS" full_name="Reward Output 2 Time" logging="WHEN_CHANGED" scope="GLOBAL" tag="LickOutput2" type="INTEGER" persistant="NO"></variable>
            <variable default_value="0" editable="ALWAYS" full_name="Reward Output 3 Time" logging="WHEN_CHANGED" scope="GLOBAL" tag="LickOutput3" type="INTEGER" persistant="NO"></variable>
        </folder>
    </variables>
    <sounds tag="Sounds">
        <sound full_name="fullname_32" path="./Sounds/DZ_sound_long_6000_right.wav" tag="StimRight" type="wav_file"></sound>
        <sound full_name="fullname_32" path="./Sounds/DZ_sound_long_600_left.wav" tag="StimLeft" type="wav_file"></sound>
        <sound full_name="fullname_32" path="./Sounds/failure_DZ.wav" tag="FailureSound2" type="wav_file"></sound>
        <sound tag="StartTrialSound" full_name="fullname_1" type="wav_file" path="./Sounds/start.wav"></sound>
        <sound tag="BlockedTrialSound" full_name="fullname_1" type="wav_file" path="./Sounds/blocked_trial.wav"></sound>
        <sound full_name="fullname_7" path="./Sounds/NRsuccess.wav" tag="RewardSound" type="wav_file"></sound>
        <sound full_name="fullname_32" path="./Sounds/failure.wav" tag="FailureSound" type="wav_file"></sound>
    </sounds>
    <stimuli tag="Stimuli">
        <stimulus tag="BlankScreen" full_name="fullname_3" type="blank_screen" color="0,0,0"></stimulus>
        <stimulus tag="BlankScreenGray" full_name="fullname_3" type="blank_screen" color="Backgr_GrayLevel, Backgr_GrayLevel, Backgr_GrayLevel"></stimulus>
        <stimulus_group tag="Stimulus_Set" full_name="">
            <stimulus tag="Blob_1_RotDep_0" type="image_file" path="Blobs_TrainingRatsD1D2/Blob_N1_CamRot_y0.png" x_size="stm_size*StimAspectRatio" y_size="stm_size*StimAspectRatio" x_position="stm_pos_x" y_position="stm_pos_y" rotation="stm_rotation" full_name=""></stimulus>
            <stimulus tag="Blob_2_RotDep_0" type="image_file" path="Blobs_TrainingRatsD1D2/Blob_N2_CamRot_y0.png" x_size="stm_size*StimAspectRatio" y_size="stm_size*StimAspectRatio" x_position="stm_pos_x" y_position="stm_pos_y" rotation="stm_rotation" full_name=""></stimulus>
        </stimulus_group>
        <stimulus_group tag="Geometrical_Shape" full_name="fullname_1">
            <stimulus tag="Shape_1" full_name="fullname_8" type="image_file" path="Images/GeomSymbol_1.png" x_size="stm_size" y_size="stm_size" x_position="stm_pos_x" y_position="stm_pos_y" rotation="stm_rotation"></stimulus>
            <stimulus tag="Shape_2" full_name="fullname_8" type="image_file" path="./Images/GeomSymbol_2.png" x_size="stm_size" y_size="stm_size" x_position="stm_pos_x" y_position="stm_pos_y" rotation="stm_rotation"></stimulus>
            <stimulus tag="Shape_3" full_name="fullname_8" type="image_file" path="./Images/GeomSymbol_3.png" x_size="20" y_size="20" x_position="stm_pos_x" y_position="stm_pos_y" rotation="0.0"></stimulus>
            <stimulus tag="Shape_4" full_name="fullname_8" type="image_file" path="./Images/GeomSymbol_4.png" x_size="20" y_size="20" x_position="stm_pos_x" y_position="stm_pos_y" rotation="0.0"></stimulus>
            <stimulus tag="Shape_5" full_name="fullname_8" type="image_file" path="./Images/GeomSymbol_5.png" x_size="20" y_size="20" x_position="stm_pos_x" y_position="stm_pos_y" rotation="0.0"></stimulus>
            <stimulus tag="Shape_6" full_name="fullname_8" type="image_file" path="./Images/GeomSymbol_6.png" x_size="20" y_size="20" x_position="stm_pos_x" y_position="0" rotation="0.0"></stimulus>
        </stimulus_group>
    </stimuli>
    <optimizers tag="Optimizers">
        <bias_monitor type="simple" tag="Bias Monitor" success="WatchSuccessBias" response_index="WatchResponseSide" task_correlation="Metric_Correct_Strategy" response_bias_correlation="Metric_Biased_Strategy" alternation_correlation="Metric_Alternation_Strategy" history="16" grace_period="16"></bias_monitor>
        <staircase tag="Staircase Optimizer Probability Free Reward" full_name="" watch="WatchSuccessStair_FreeRew" output="p_FreeRew_current" lower_limit="p_FreeRew_lower_limit" upper_limit="p_FreeRew_upper_limit" up_criterion="FreeRew_stair_up_criterion" down_criterion="FreeRew_stair_down_criterion" step_size="p_FreeRew_stair_step" grace_period="10" history="10"></staircase>
        <staircase tag="Staircase Optimizer Horizontal Stimulus Separation" full_name="" watch="WatchSuccessStair_HorizSep" output="deg_HorizSep_current" lower_limit="deg_HorizSep_lower_limit" upper_limit="deg_HorizSep_upper_limit" up_criterion="HorizSep_stair_up_criterion" down_criterion="HorizSep_stair_down_criterion" step_size="deg_HorizSep_stair_step" grace_period="10" history="10"></staircase>
        <staircase tag="Staircase Optimizer Size" full_name="fullname_1" watch="WatchSuccessStair_size" output="N_sizes_stair_current" lower_limit="0" upper_limit="N_sizes_stair_upper_limit" up_criterion="size_stair_up_criterion" down_criterion="size_stair_down_criterion" step_size="1" grace_period="10" history="10"></staircase>
        <staircase tag="Staircase Optimizer Position Horizontal Right HR" full_name="fullname_1" watch="WatchSuccessStair_PosHR" output="N_PosHR_stair_current" lower_limit="0" upper_limit="N_PosHR_stair_upper_limit" up_criterion="PosHR_stair_up_criterion" down_criterion="PosHR_stair_down_criterion" step_size="1" grace_period="10" history="10"></staircase>
        <staircase tag="Staircase Optimizer Position Horizontal Right HL" full_name="fullname_1" watch="WatchSuccessStair_PosHL" output="N_PosHL_stair_current" lower_limit="0" upper_limit="N_PosHL_stair_upper_limit" up_criterion="PosHL_stair_up_criterion" down_criterion="PosHL_stair_down_criterion" step_size="1" grace_period="10" history="10"></staircase>
        <staircase tag="Staircase Optimizer Position Horizontal Right VU" full_name="fullname_1" watch="WatchSuccessStair_PosVU" output="N_PosVU_stair_current" lower_limit="0" upper_limit="N_PosVU_stair_upper_limit" up_criterion="PosVU_stair_up_criterion" down_criterion="PosVU_stair_down_criterion" step_size="1" grace_period="10" history="10"></staircase>
        <staircase tag="Staircase Optimizer Position Horizontal Right VD" full_name="fullname_1" watch="WatchSuccessStair_PosVD" output="N_PosVD_stair_current" lower_limit="0" upper_limit="N_PosVD_stair_upper_limit" up_criterion="PosVD_stair_up_criterion" down_criterion="PosVD_stair_down_criterion" step_size="1" grace_period="10" history="10"></staircase>
        <staircase tag="Staircase Optimizer Rotation CW" full_name="fullname_1" watch="WatchSuccessStair_RotCW" output="N_RotCW_stair_current" lower_limit="0" upper_limit="N_RotCW_stair_upper_limit" up_criterion="RotCW_stair_up_criterion" down_criterion="RotCW_stair_down_criterion" step_size="1" grace_period="10" history="10"></staircase>
        <staircase tag="Staircase Optimizer Rotation ACW" full_name="fullname_1" watch="WatchSuccessStair_RotACW" output="N_RotACW_stair_current" lower_limit="0" upper_limit="N_RotACW_stair_upper_limit" up_criterion="RotACW_stair_up_criterion" down_criterion="RotACW_stair_down_criterion" step_size="1" grace_period="10" history="10"></staircase>
    </optimizers>
    <experiment tag="Experiment" full_name="My Experiment" description="">
        <protocol tag="Early Training Protocol" full_name="fullname_1" description="" interruptible="YES" selection="sequential" nsamples="1" sampling_method="cycles">
            <block tag="Early Training Protocol Block" full_name="fullname_2" description="" interruptible="YES" selection="sequential" nsamples="1" sampling_method="cycles">
                <trial tag="Early Training Protocol Trial" full_name="fullname_3" description="" interruptible="YES" selection="sequential" nsamples="1" sampling_method="cycles">
                    <action device="phidget" full_name="fullname_4" tag="StartDeviceIO" type="start_device_io"></action>
                    <action device="NE500" full_name="fullname_4" tag="StartDeviceIO2" type="start_device_io"></action>
                    <list tag="ETP Blob Shapes" full_name="List of Random geometrical shapes" description="Randomly sample a task system in which one of the many possible geometrical shapes is used" interruptible="YES" selection="random_with_replacement" nsamples="5000" sampling_method="cycles">
                        <range_replicator tag="ETP Loop on Blobs" full_name="fullname_9" from="0" to="1" step="1" variable="ImageIndex">
                            <task_system tag="Early Training Task" full_name="fullname_6" description="" interruptible="YES">
                                <task_system_state tag="ETP Initialize" full_name="fullname_10" description="Initialize the current trial" interruptible="YES">
                                    <action tag="Initialize FlagAddFreeRewardToEarnedReward to 1" full_name="fullname_2" type="assignment" variable="FlagAddFreeRewardToEarnedReward" value="1"></action>
                                    <action tag="Initialize FlagDiscardCurrStim to 0" full_name="fullname_2" type="assignment" variable="FlagDiscardCurrStim" value="0"></action>
                                    <action type="if" tag="if FlagAutomaticBiasSuppression" condition="FlagAutomaticBiasSuppression == 1">
                                        <action type="if" tag="if task strategy is biased" condition="abs(Metric_Biased_Strategy) > Adjusted_Metric_Correct_Strategy">
                                            <action full_name="fullname_6" message=">>>>>> STRATEGY IS BIASED!!" tag="Report" type="report"></action>
                                            <action type="if" tag="if bias is to the left" condition="Metric_Biased_Strategy &lt; 0">
                                                <action type="assignment" tag="enable right stimulus presentation" variable="FlagShowStimRight" value="1"></action>
                                                <action type="assignment" tag="disable left stimulus presentation" variable="FlagShowStimLeft" value="0"></action>
                                            </action>
                                            <action type="if" tag="if bias is to the right" condition="Metric_Biased_Strategy > 0">
                                                <action type="assignment" tag="disable right stimulus presentation" variable="FlagShowStimRight" value="0"></action>
                                                <action type="assignment" tag="enable left stimulus presentation" variable="FlagShowStimLeft" value="1"></action>
                                            </action>
                                        </action>
                                        <action type="if" tag="if task strategy is NOT biased" condition="abs(Metric_Biased_Strategy) #LE Adjusted_Metric_Correct_Strategy">
                                            <action type="assignment" tag="enable left stimulus presentation" variable="FlagShowStimLeft" value="1"></action>
                                            <action type="assignment" tag="enable right stimulus presentation" variable="FlagShowStimRight" value="1"></action>
                                        </action>
                                    </action>
                                    <action type="if" tag="If do not show right stim" condition="FlagShowStimRight == 0">
                                        <action type="if" tag="if this is the right stimulus" condition="ImageIndex == 0">
                                            <action type="if" tag="If discarding right stimulus is allowed" condition="FlagAlwaysEnforceMaxSeqLeng == 0 #OR (FlagAlwaysEnforceMaxSeqLeng == 1 #AND LeftStim_Counter #LT MaxN_IdenticalStims)">
                                                <action full_name="fullname_6" message="Discard right stimulus ..." tag="Report" type="report"></action>
                                                <action tag="set FlagDiscardCurrStim to 1" full_name="fullname_2" type="assignment" variable="FlagDiscardCurrStim" value="1"></action>
                                            </action>
                                        </action>
                                    </action>
                                    <action type="if" tag="If do not show left stim" condition="FlagShowStimLeft == 0">
                                        <action type="if" tag="if this is the left stimulus" condition="ImageIndex == 1">
                                            <action type="if" tag="If discarding left stimulus is allowed" condition="FlagAlwaysEnforceMaxSeqLeng == 0 #OR (FlagAlwaysEnforceMaxSeqLeng == 1 #AND RightStim_Counter #LT MaxN_IdenticalStims)">
                                                <action full_name="fullname_6" message="Discard left stimulus ..." tag="Report" type="report"></action>
                                                <action tag="set FlagDiscardCurrStim to 1" full_name="fullname_2" type="assignment" variable="FlagDiscardCurrStim" value="1"></action>
                                            </action>
                                        </action>
                                    </action>
                                    <action tag="If FlagStaircaseHorizSeparation" full_name="fullname_4" type="if" condition="FlagStaircaseHorizSeparation == 1">
                                        <action tag="Set the abs_x_pos to current value given by the staircase" full_name="fullname_23" type="assignment" variable="abs_stm_pos_x" value="deg_HorizSep_current"></action>
                                    </action>
                                    <action full_name="fullname_6" message="Initialize ETP trial ..." tag="Report" type="report"></action>
                                    <action tag="CheckForBlockedTrialTime" full_name="fullname_1" type="start_timer" timer="CheckForBlockedTrialTimer" duration="CheckForBlockedTrialDuration" timebase=""></action>
                                    <transition tag="If too many identical stims in a row" full_name="fullname_13" target="ETP Finish" type="conditional" condition="FlagRepeatedTrial == 0 #AND ((FlagShowStimRight == 1 #AND FlagShowStimLeft == 1) #OR FlagAlwaysEnforceMaxSeqLeng == 1) #AND ( (ImageIndex == 0 #AND RightStim_Counter #GE MaxN_IdenticalStims) #OR (ImageIndex == 1 #AND LeftStim_Counter #GE MaxN_IdenticalStims) )"></transition>
                                    <transition tag="If trial contains NOT allowed stimulus" full_name="fullname_3" target="ETP Finish" type="conditional" condition="FlagDiscardCurrStim == 1"></transition>
                                    <transition tag="If already licking..." full_name="fullname_11" target="ETP Block Trial" type="conditional" condition="LickInput1 #GT 800 #OR LickInput3 #GT 800"></transition>
                                    <transition tag="if Timer Expired..." full_name="fullname_3" target="ETP Wait For Trigger Trial" type="timer_expired" timer="CheckForBlockedTrialTimer"></transition>
                                </task_system_state>
                                <task_system_state tag="ETP Block Trial" full_name="Block Trial" description="Block current trial is rat is licking before the starting tone" interruptible="YES">
                                    <action full_name="fullname_6" message="Block the trial ..." tag="Report" type="report"></action>
                                    <action duration="BlockTrial_time" full_name="fullname_15" tag="Start Block Trial Timer" timer="BlockTrial_timer" type="start_timer" timebase=""></action>
                                    <transition tag="If Timer Expired..." full_name="fullname_18" target="ETP Initialize" type="timer_expired" timer="BlockTrial_timer"></transition>
                                </task_system_state>
                                <task_system_state tag="ETP Wait For Trigger Trial" full_name="fullname_10" description="Initialize the current trial" interruptible="YES">
                                    <action full_name="fullname_6" message="Wait for animal triggering the trial ..." tag="Report" type="report"></action>
                                    <action tag="Start Wait For Trigger Timer" full_name="fullname_1" type="start_timer" timer="WaitForTrigger_timer" duration="WaitForTrigger_time" timebase=""></action>
                                    <transition tag="If touching trigger port and allowed stimulus" full_name="fullname_11" target="ETP Pre-show stimulus" type="conditional" condition="LickInput2 #GT 500"></transition>
                                    <transition tag="If already licking..." full_name="fullname_11" target="ETP Block Trial" type="conditional" condition="LickInput1 #GT 500 #OR LickInput3 #GT 500"></transition>
                                    <transition tag="if Timer Expired..." full_name="fullname_3" target="ETP Wait For Trigger Trial" type="timer_expired" timer="WaitForTrigger_timer"></transition>
                                </task_system_state>
                                <task_system_state tag="ETP Pre-show stimulus" full_name="fullname_10" description="" interruptible="YES">
                                    <action tag="Announce start trial" full_name="fullname_10" type="assignment" variable="Announce_TrialStart" value="1"></action>
                                    <action tag="Start wait for trigger tone duration" full_name="fullname_1" type="start_timer" timer="WaitForTriggerToneDuration_timer" duration="WaitForTriggerToneDuration_time" timebase=""></action>
                                    <transition tag="If Timer Expired" full_name="fullname_13" target="ETP Show Stimulus" type="timer_expired" timer="WaitForTriggerToneDuration_timer"></transition>
                                </task_system_state>
                                <task_system_state tag="ETP Show Stimulus" full_name="fullname_1" description="" interruptible="YES">
                                    <action full_name="fullname_6" message="Triggered stimulus presentation... FlagRepeatedTrial: $FlagRepeatedTrial" tag="Report" type="report"></action>
                                    <action tag="If Shape # 1" full_name="fullname_11" type="if" condition="ImageIndex == 0">
                                        <action tag="Report" type="report" message="--- show SHAPE # 1" full_name=""></action>
                                        <action tag="set stm_pos_x" full_name="set stm_pos_x" type="assignment" variable="stm_pos_x" value="abs_stm_pos_x"></action>
                                        <action tag="set stm_pos_y" full_name="set stm_pos_y" type="assignment" variable="stm_pos_y" value="0"></action>
                                        <action tag="If NOT a Correction/repeated Trial" type="if" condition="FlagRepeatedTrial == 0" full_name="">
                                            <action tag="Report" type="report" message="... inside if: initialize stim counters" full_name=""></action>
                                            <action tag="Initialize to zero left stim counter" full_name="fullname_3" type="assignment" variable="LeftStim_Counter" value="0"></action>
                                            <action tag="Increment right stim counter" full_name="fullname_3" type="assignment" variable="RightStim_Counter" value="RightStim_Counter+1"></action>
                                        </action>
                                        <action tag="If cue stim with a reinforcement sound" full_name="fullname_2" type="if" condition="FlagCueStimSound == 1">
                                            <action tag="Report" type="report" message="... inside if: play cue stim sound" full_name=""></action>
                                            <action full_name="fullname_14" sound="StimRight" tag="Play right stimulus sound" type="play_sound"></action>
                                        </action>
                                        <action full_name="fullname_17" tag="Give Reward" type="assignment" value="cue_reward_duration" variable="LickOutput3"></action>
                                    </action>
                                    <action tag="If Shape # 2" full_name="fullname_11" type="if" condition="ImageIndex == 1">
                                        <action tag="Report" type="report" message="--- show SHAPE # 2" full_name=""></action>
                                        <action tag="set stm_pos_x" full_name="set stm_pos_x" type="assignment" variable="stm_pos_x" value="-abs_stm_pos_x"></action>
                                        <action tag="set stm_pos_y" full_name="set stm_pos_y" type="assignment" variable="stm_pos_y" value="0"></action>
                                        <action tag="If NOT a Correction/repeated Trial" type="if" condition="FlagRepeatedTrial == 0" full_name="">
                                            <action tag="Report" type="report" message="... inside if: initialize stim counters" full_name=""></action>
                                            <action tag="Initialize to zero right stim counter" full_name="fullname_3" type="assignment" variable="RightStim_Counter" value="0"></action>
                                            <action tag="Increment left stim counter" full_name="fullname_3" type="assignment" variable="LeftStim_Counter" value="LeftStim_Counter+1"></action>
                                        </action>
                                        <action tag="If cue stim with a reinforcement sound" full_name="fullname_2" type="if" condition="FlagCueStimSound == 1">
                                            <action tag="Report" type="report" message="... inside if: play cue stim sound" full_name=""></action>
                                            <action full_name="fullname_14" sound="StimLeft" tag="Play left stimulus sound" type="play_sound"></action>
                                        </action>
                                        <action full_name="fullname_17" tag="Give Reward" type="assignment" value="cue_reward_duration" variable="LickOutput1"></action>
                                    </action>
                                    <action tag="If show visual stimuli" type="if" condition="FlagShowVisualStimuli == 1" full_name="">
                                        <action tag="queue background" full_name="queue stm" type="queue_stimulus" stimulus="BlankScreen"></action>
                                        <action tag="queue stm" full_name="queue stm" type="queue_stimulus" stimulus="Stimulus_Set[ImageIndex]"></action>
                                        <action tag="Announce stim on" full_name="fullname_10" type="assignment" variable="Announce_StimOn" value="1"></action>
                                        <action tag="show stm" full_name="show stm" type="update_stimulus_display"></action>
                                    </action>
                                    <action duration="StimulusPresentation_time - CueStimSoundPresentation_time" full_name="fullname_15" tag="Start Stim Duration Timer" timer="StimulusPresentation_timer" type="start_timer" timebase=""></action>
                                    <action duration="CueStimSoundPresentation_time" full_name="fullname_15" tag="Start Sound Duration Timer" timer="CueStimSoundPresentation_timer" type="start_timer" timebase=""></action>
                                    <action duration="TooFast_time" full_name="fullname_15" tag="Start TooFast Timer" timer="TooFast_timer" type="start_timer" timebase=""></action>
                                    <transition tag="if Lick Port 1 or 3" full_name="fullname_1" target="ETP Aborted" type="conditional" condition="LickInput1 #GT 500 #OR LickInput3 #GT 500"></transition>
                                    <transition tag="if Too Fast timer expired" full_name="fullname_6" target="ETP Keep playing sound" type="timer_expired" timer="TooFast_timer"></transition>
                                </task_system_state>
                                <task_system_state tag="ETP Keep playing sound" full_name="fullname_1" description="" interruptible="YES">
                                    <action full_name="fullname_6" message="Keep playing sound ..." tag="Report" type="report"></action>
                                    <transition tag="if Lick Port 1" full_name="fullname_1" target="ETP Acquire Port 1" type="conditional" condition="LickInput1 #GT 500"></transition>
                                    <transition tag="if Lick Port 3" full_name="fullname_3" target="ETP Acquire Port 3" type="conditional" condition="LickInput3 #GT 500"></transition>
                                    <transition tag="If Sound Duration Timer Expired" full_name="fullname_15" target="ETP Keep stim ON after cue sound offset" type="timer_expired" timer="CueStimSoundPresentation_timer"></transition>
                                </task_system_state>
                                <task_system_state tag="ETP Keep stim ON after cue sound offset" full_name="fullname_1" description="" interruptible="YES">
                                    <action full_name="fullname_6" message="Keep showing stimulus after sound offset ..." tag="Report" type="report"></action>
                                    <action tag="Stop right stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimRight"></action>
                                    <action tag="Stop left stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimLeft"></action>
                                    <transition tag="if Lick Port 1" full_name="fullname_1" target="ETP Acquire Port 1" type="conditional" condition="LickInput1 #GT 500"></transition>
                                    <transition tag="if Lick Port 3" full_name="fullname_3" target="ETP Acquire Port 3" type="conditional" condition="LickInput3 #GT 500"></transition>
                                    <transition tag="If Timer Expired" full_name="fullname_15" target="ETP Stimulus Off" type="timer_expired" timer="StimulusPresentation_timer"></transition>
                                </task_system_state>
                                <task_system_state tag="ETP Stimulus Off" full_name="fullname_12" description="" interruptible="YES">
                                    <action tag="dequeue stm" full_name="dequeue stm" type="dequeue_stimulus" stimulus="Stimulus_Set[ImageIndex]"></action>
                                    <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                    <action tag="Announce stim off" full_name="fullname_10" type="assignment" variable="Announce_StimOff" value="1"></action>
                                    <action duration="acquire_time - StimulusPresentation_time" full_name="fullname_15" tag="Start Acquire Timer" timer="acquire_timer" type="start_timer" timebase=""></action>
                                    <transition condition="LickInput1 #GT 500" full_name="fullname_25" tag="If Lick Port 1" target="ETP Acquire Port 1" type="conditional"></transition>
                                    <transition tag="if Lick Port 3" full_name="fullname_4" target="ETP Acquire Port 3" type="conditional" condition="LickInput3 #GT 500"></transition>
                                    <transition tag="If Timer Expired" full_name="fullname_1" target="ETP Ignored" type="timer_expired" timer="acquire_timer"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="Acquire State" interruptible="YES" tag="ETP Acquire Port 1">
                                    <action tag="Announce trigger port 1" full_name="fullname_10" type="assignment" variable="Announce_AcquirePort1" value="1"></action>
                                    <action full_name="fullname_6" message="Response Acquired on Port 1 ..." tag="Report" type="report"></action>
                                    <action tag="Stop left stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimLeft"></action>
                                    <action tag="Stop right stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimRight"></action>
                                    <action type="assignment" tag="Set WatchResponseSide to -1 (LEFT port)" variable="WatchResponseSide" value="-1"></action>
                                    <transition tag="Correct Response" full_name="fullname_6" target="ETP Pre-Reward Port 1" type="conditional" condition="ImageIndex == 1"></transition>
                                    <transition tag="Wrong Response" full_name="fullname_7" target="ETP Failure" type="conditional" condition="ImageIndex == 0"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="Acquire State" interruptible="YES" tag="ETP Pre-Reward Port 1">
                                    <action full_name="fullname_6" message="Pre-Reward Port 1 ..." tag="Report" type="report"></action>
                                    <action tag="If don't display stim after response" full_name="fullname_1" type="if" condition="FlagShowStimAfterResponse == 0">
                                        <action tag="If_2" type="if" condition="1" full_name=""></action>
                                        <action tag="dequeue stm" full_name="dequeue stm" type="dequeue_stimulus" stimulus="Stimulus_Set[ImageIndex]"></action>
                                        <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                        <action tag="Announce stim off" full_name="fullname_10" type="assignment" variable="Announce_StimOff" value="1"></action>
                                    </action>
                                    <action tag="If play outcome sound" type="if" condition="FlagPlayOutcomeSound == 1" full_name=""></action>
                                    <action tag="Update success" full_name="fullname_6" type="assignment" variable="success" value="1"></action>
                                    <action tag="If always reward" full_name="fullname_2" type="if" condition="FlagAlwaysReward == 1">
                                        <action tag="If staircase prob free reward is active" full_name="fullname_4" type="if" condition="FlagStaircaseProbFreeRew ==1">
                                            <action tag="Update WatchSuccessStair_FreeRew" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_FreeRew" value="1"></action>
                                        </action>
                                    </action>
                                    <action tag="If FlagStaircaseHorizSeparation" full_name="fullname_4" type="if" condition="FlagStaircaseHorizSeparation == 1">
                                        <action tag="Update WatchSuccessStair_FreeRew" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_HorizSep" value="1"></action>
                                    </action>
                                    <action tag="Update WatchSuccessBias" full_name="fullname_6" type="assignment" variable="WatchSuccessBias" value="1"></action>
                                    <action duration="prestim_time" full_name="fullname_16" tag="Start PreStim Timer" timer="prestim_timer" type="start_timer" timebase=""></action>
                                    <transition full_name="fullname_21" tag="If Timer Expired..." target="ETP Reward Port 1" timer="prestim_timer" type="timer_expired"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="fullname_11" interruptible="YES" tag="ETP Reward Port 1">
                                    <action full_name="fullname_6" message="REWARD!" tag="Report" type="report"></action>
                                    <action tag="If reward more than maximum allowed" full_name="fullname_21" type="if" condition="reward_duration #GT maximal_reward_duration">
                                        <action full_name="fullname_6" message="reset reward to maximum!" tag="Report" type="report"></action>
                                        <action tag="reset reward to maximum" full_name="fullname_20" type="assignment" variable="reward_duration" value="maximal_reward_duration"></action>
                                    </action>
                                    <action tag="Set current reward duration" full_name="fullname_7" type="assignment" variable="curr_reward_duration" value="reward_duration + (FlagAddFreeRewardToEarnedReward* FlagAlwaysReward*cue_reward_duration)"></action>
                                    <action full_name="fullname_17" tag="Give Reward" type="assignment" value="curr_reward_duration" variable="LickOutput1"></action>
                                    <action tag="If play outcome sound" type="if" condition="FlagPlayOutcomeSound == 1" full_name="">
                                        <action full_name="fullname_31" sound="RewardSound" tag="Play Reward Tone" type="play_sound"></action>
                                    </action>
                                    <transition full_name="fullname_23" tag="Goto Licking Time" target="ETP Additional Licking Time" type="direct"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="Acquire State" interruptible="YES" tag="ETP Acquire Port 3">
                                    <action tag="Announce trigger port 3" full_name="fullname_10" type="assignment" variable="Announce_AcquirePort3" value="1"></action>
                                    <action full_name="fullname_6" message="Response Acquired on Port 3 ..." tag="Report" type="report"></action>
                                    <action tag="Stop left stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimLeft"></action>
                                    <action tag="Stop right stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimRight"></action>
                                    <action type="assignment" tag="Set WatchResponseSide to 1 (RIGHT port)" variable="WatchResponseSide" value="1"></action>
                                    <transition tag="Correct Response" full_name="fullname_8" target="ETP Pre-Reward Port 3" type="conditional" condition="ImageIndex == 0"></transition>
                                    <transition tag="Wrong Response" full_name="fullname_9" target="ETP Failure" type="conditional" condition="ImageIndex == 1"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="Acquire State" interruptible="YES" tag="ETP Pre-Reward Port 3">
                                    <action full_name="fullname_6" message="Response Acquired ..." tag="Pre-Reward Port 3" type="report"></action>
                                    <action tag="If don't display stim after response" full_name="fullname_1" type="if" condition="FlagShowStimAfterResponse == 0">
                                        <action tag="dequeue stm" full_name="dequeue stm" type="dequeue_stimulus" stimulus="Stimulus_Set[ImageIndex]"></action>
                                        <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                        <action tag="Announce stim off" full_name="fullname_10" type="assignment" variable="Announce_StimOff" value="1"></action>
                                    </action>
                                    <action tag="If play outcome sound" type="if" condition="FlagPlayOutcomeSound == 1" full_name=""></action>
                                    <action tag="Update success" full_name="fullname_6" type="assignment" variable="success" value="1"></action>
                                    <action tag="If always reward" full_name="fullname_2" type="if" condition="FlagAlwaysReward == 1">
                                        <action tag="If staircase prob free reward is active" full_name="fullname_4" type="if" condition="FlagStaircaseProbFreeRew ==1">
                                            <action tag="Update WatchSuccessStair_FreeRew" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_FreeRew" value="1"></action>
                                        </action>
                                    </action>
                                    <action tag="If FlagStaircaseHorizSeparation" full_name="fullname_4" type="if" condition="FlagStaircaseHorizSeparation == 1">
                                        <action tag="Update WatchSuccessStair_FreeRew" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_HorizSep" value="1"></action>
                                    </action>
                                    <action tag="Update WatchSuccessBias" full_name="fullname_6" type="assignment" variable="WatchSuccessBias" value="1"></action>
                                    <action duration="prestim_time" full_name="fullname_16" tag="Start PreStim Timer" timer="prestim_timer" type="start_timer" timebase=""></action>
                                    <transition full_name="fullname_21" tag="If Timer Expired..." target="ETP Reward Port 3" timer="prestim_timer" type="timer_expired"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="fullname_11" interruptible="YES" tag="ETP Reward Port 3">
                                    <action full_name="fullname_6" message="REWARD!" tag="Report" type="report"></action>
                                    <action tag="If reward more than maximum allowed" full_name="fullname_21" type="if" condition="reward_duration #GT maximal_reward_duration">
                                        <action full_name="fullname_6" message="reset reward to maximum!" tag="Report" type="report"></action>
                                        <action tag="reset reward to maximum" full_name="fullname_20" type="assignment" variable="reward_duration" value="maximal_reward_duration"></action>
                                    </action>
                                    <action tag="Set current reward duration" full_name="fullname_7" type="assignment" variable="curr_reward_duration" value="reward_duration + (FlagAddFreeRewardToEarnedReward* FlagAlwaysReward*cue_reward_duration)"></action>
                                    <action full_name="fullname_17" tag="Give Reward" type="assignment" value="curr_reward_duration" variable="LickOutput3"></action>
                                    <action tag="If play outcome sound" type="if" condition="FlagPlayOutcomeSound == 1" full_name="">
                                        <action full_name="fullname_31" sound="RewardSound" tag="Play Reward Tone" type="play_sound"></action>
                                    </action>
                                    <transition full_name="fullname_23" tag="Goto Licking Time" target="ETP Additional Licking Time" type="direct"></transition>
                                </task_system_state>
                                <task_system_state tag="ETP Additional Licking Time" full_name="fullname_1" description="" interruptible="YES">
                                    <action full_name="fullname_6" message="Give additional Licking time ..." tag="Report" type="report"></action>
                                    <action tag="If reward less than maximum allowed" full_name="fullname_21" type="if" condition="reward_duration #LT maximal_reward_duration">
                                        <action tag="Increment reward" full_name="fullname_20" type="assignment" variable="reward_duration" value="reward_duration + increment_reward_duration"></action>
                                    </action>
                                    <action duration="licking_time" full_name="fullname_16" tag="Start licking Timer" timer="licking_timer" type="start_timer" timebase=""></action>
                                    <transition tag="If Timer Expired ..." full_name="fullname_5" target="ETP Idle" type="timer_expired" timer="licking_timer"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="fullname_12" interruptible="YES" tag="ETP Failure">
                                    <action full_name="fullname_6" message="Failed..." tag="Report" type="report"></action>
                                    <action tag="Initialize reward to minimum" full_name="fullname_20" type="assignment" variable="reward_duration" value="minimal_reward_duration"></action>
                                    <action tag="Initialize punishment cycle index" full_name="fullname_19" type="assignment" variable="PunishmentCyclesIndex" value="0"></action>
                                    <action tag="If play outcome sound" type="if" condition="FlagPlayOutcomeSound == 1" full_name="">
                                        <action full_name="fullname_31" sound="FailureSound2" tag="Play Failure Tone" type="play_sound"></action>
                                    </action>
                                    <action tag="Update failure" full_name="fullname_6" type="assignment" variable="failure" value="1"></action>
                                    <action tag="If always reward" full_name="fullname_2" type="if" condition="FlagAlwaysReward == 1">
                                        <action tag="If staircase prob free reward is active" full_name="fullname_4" type="if" condition="FlagStaircaseProbFreeRew ==1">
                                            <action tag="Update WatchSuccessStair_FreeRew" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_FreeRew" value="0"></action>
                                        </action>
                                    </action>
                                    <action tag="If FlagStaircaseHorizSeparation" full_name="fullname_4" type="if" condition="FlagStaircaseHorizSeparation == 1">
                                        <action tag="Update WatchSuccessStair_FreeRew" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_HorizSep" value="0"></action>
                                    </action>
                                    <action tag="Update WatchSuccessBias" full_name="fullname_6" type="assignment" variable="WatchSuccessBias" value="0"></action>
                                    <action tag="dequeue stm" full_name="dequeue stm" type="dequeue_stimulus" stimulus="Stimulus_Set[ImageIndex]"></action>
                                    <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                    <action tag="Announce stim off" full_name="fullname_10" type="assignment" variable="Announce_StimOff" value="1"></action>
                                    <transition tag="Go into Punishment Loop" full_name="fullname_2" target="ETP Punishment Loop Gray" type="conditional" condition="FlagLongPunishment == 1"></transition>
                                    <transition tag="Goto Idle" full_name="fullname_3" target="ETP Idle" type="conditional" condition="FlagLongPunishment == 0"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="fullname_12" interruptible="YES" tag="ETP Punishment Loop Gray">
                                    <action full_name="fullname_6" message="Failed: punish with gray background" tag="Report" type="report"></action>
                                    <action full_name="fullname_31" sound="FailureSound" tag="Play Failure Tone" type="play_sound"></action>
                                    <action tag="queue gray background" full_name="queue stm" type="queue_stimulus" stimulus="BlankScreenGray"></action>
                                    <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                    <action duration="backgr_punish_flickering_period" full_name="fullname_16" tag="Start gray background Timer" timer="background_timer" type="start_timer" timebase=""></action>
                                    <transition tag="If Timer Expired ..." full_name="fullname_14" target="ETP Punishment Loop Black" type="timer_expired" timer="background_timer"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="fullname_12" interruptible="YES" tag="ETP Punishment Loop Black">
                                    <action full_name="fullname_6" message="Failed: punish with black background pc: $PunishmentCyclesIndex npc: $N_PunishmentCycles" tag="Report" type="report"></action>
                                    <action tag="Update punishment cycle index" full_name="fullname_19" type="assignment" variable="PunishmentCyclesIndex" value="PunishmentCyclesIndex + 1"></action>
                                    <action full_name="fullname_31" sound="FailureSound2" tag="Play Failure Tone" type="play_sound"></action>
                                    <action tag="dequeue gray background" full_name="dequeue stm" type="dequeue_stimulus" stimulus="BlankScreenGray"></action>
                                    <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                    <action duration="backgr_punish_flickering_period" full_name="fullname_16" tag="Start black background Timer" timer="background_timer" type="start_timer" timebase=""></action>
                                    <transition tag="Repeat current trial as a correction" full_name="fullname_1" target="ETP Prepare for correction trial" type="conditional" condition="PunishmentCyclesIndex #GT N_PunishmentCycles #AND FlagCorrectionTrials == 1"></transition>
                                    <transition tag="Exit loop and jump to Idle" full_name="fullname_17" target="ETP Idle" type="conditional" condition="PunishmentCyclesIndex #GT N_PunishmentCycles #AND FlagCorrectionTrials == 0"></transition>
                                    <transition tag="If Timer Expired ..." full_name="fullname_24" target="ETP Punishment Loop Gray" type="timer_expired" timer="background_timer"></transition>
                                </task_system_state>
                                <task_system_state tag="ETP Prepare for correction trial" description="" interruptible="YES" full_name="">
                                    <action full_name="fullname_6" message="... Prepare for CORRECTIO TRIAL. FlagRepeatedTrial: $FlagRepeatedTrial" tag="Report" type="report"></action>
                                    <action tag="Signal that the next will be a correction trial" type="assignment" variable="FlagRepeatedTrial" value="1" full_name=""></action>
                                    <action full_name="fullname_6" message=".... FlagRepeatedTrial changed to: $FlagRepeatedTrial" tag="Report" type="report"></action>
                                    <transition tag="Go back to initialize" target="ETP Initialize" type="direct" full_name=""></transition>
                                </task_system_state>
                                <task_system_state tag="ETP Aborted" full_name="fullname_7" description="" interruptible="YES">
                                    <action full_name="fullname_6" message="Aborted ..." tag="Report" type="report"></action>
                                    <action tag="If play outcome sound" type="if" condition="FlagPlayOutcomeSound == 1" full_name="">
                                        <action full_name="fullname_31" sound="FailureSound2" tag="Play Failure Tone" type="play_sound"></action>
                                    </action>
                                    <action tag="Initialize reward to minimum" full_name="fullname_20" type="assignment" variable="reward_duration" value="minimal_reward_duration"></action>
                                    <action tag="Stop left stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimLeft"></action>
                                    <action tag="Stop right stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimRight"></action>
                                    <action tag="dequeue stm" full_name="dequeue stm" type="dequeue_stimulus" stimulus="Stimulus_Set[ImageIndex]"></action>
                                    <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                    <action tag="Announce stim off" full_name="fullname_10" type="assignment" variable="Announce_StimOff" value="1"></action>
                                    <transition tag="AlwaysGo to Idle" full_name="fullname_14" target="ETP Idle" type="direct"></transition>
                                </task_system_state>
                                <task_system_state tag="ETP Ignored" full_name="fullname_11" description="" interruptible="YES">
                                    <action full_name="fullname_6" message="Ignored ..." tag="Report" type="report"></action>
                                    <action tag="Update ignored" full_name="fullname_6" type="assignment" variable="ignore" value="1"></action>
                                    <transition tag="AlwaysGo to Idle" full_name="fullname_13" target="ETP Idle" type="direct"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="fullname_13" interruptible="YES" tag="ETP Idle">
                                    <action full_name="fullname_6" message="idling..." tag="Report" type="report"></action>
                                    <action tag="dequeue stm" full_name="dequeue stm" type="dequeue_stimulus" stimulus="Stimulus_Set[ImageIndex]"></action>
                                    <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                    <action tag="Announce stim off" full_name="fullname_10" type="assignment" variable="Announce_StimOff" value="1"></action>
                                    <action tag="Announce end trial" full_name="fullname_10" type="assignment" variable="Announce_TrialEnd" value="1"></action>
                                    <action duration="intertrial_interval" full_name="fullname_19" tag="Start Idle Timer" timer="idle_timer" type="start_timer" timebase=""></action>
                                    <transition full_name="fullname_20" tag="If Timer Expired..." target="ETP Finish" timer="idle_timer" type="timer_expired"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="fullname_3" interruptible="YES" tag="ETP Finish">
                                    <action full_name="fullname_6" message="Yielding ..." tag="Report" type="report"></action>
                                    <action tag="Reset Flag telling the next is a correction trial to zero" full_name="fullname_10" type="assignment" variable="FlagRepeatedTrial" value="0"></action>
                                    <action type="assignment" tag="Compute the Adjusted_Metric_Correct_Strategy" variable="Adjusted_Metric_Correct_Strategy" value="GainFactorCorrectMetric * Metric_Correct_Strategy"></action>
                                    <action full_name="fullname_6" message="Reset FlagRepeatedTrial to $FlagRepeatedTrial" tag="Report" type="report"></action>
                                    <action tag="Reset Announce trial no feedback to zero" full_name="fullname_10" type="assignment" variable="Announce_TrialNoFeedback" value="0"></action>
                                    <action tag="Reset Announce start trial to zero" full_name="fullname_10" type="assignment" variable="Announce_TrialStart" value="0"></action>
                                    <action tag="Reset Announce end trial to zero" full_name="fullname_10" type="assignment" variable="Announce_TrialEnd" value="0"></action>
                                    <action tag="Reset Announce stim on to zero" full_name="fullname_10" type="assignment" variable="Announce_StimOn" value="0"></action>
                                    <action tag="Reset Announce stim off to zero" full_name="fullname_10" type="assignment" variable="Announce_StimOff" value="0"></action>
                                    <action tag="Reset Announce acquire port 1 to zero" full_name="fullname_10" type="assignment" variable="Announce_AcquirePort1" value="0"></action>
                                    <action tag="Reset Announce acquire port 3 to zero" full_name="fullname_10" type="assignment" variable="Announce_AcquirePort3" value="0"></action>
                                    <action tag="Reset Announce trial no feedback to zero" full_name="fullname_10" type="assignment" variable="Announce_TrialNoFeedback" value="0"></action>
                                    <transition full_name="fullname_5" tag="Yield" type="yield" target="~STATE_REF~"></transition>
                                </task_system_state>
                            </task_system>
                        </range_replicator>
                    </list>
                    <action device="phidget" full_name="fullname_5" tag="StopDeviceIO" type="stop_device_io"></action>
                    <action device="NE500" full_name="fullname_5" tag="StopDeviceIO2" type="stop_device_io"></action>
                </trial>
            </block>
        </protocol>
        <protocol tag="Initiate VIsual Pres Protocol" full_name="fullname_1" description="" interruptible="YES" selection="sequential" nsamples="1" sampling_method="cycles">
            <block tag="Initiate VIsual Pres Block" full_name="fullname_2" description="" interruptible="YES" selection="sequential" nsamples="1" sampling_method="cycles">
                <trial tag="Initiate VIsual Pres Trial" full_name="fullname_3" description="" interruptible="YES" selection="sequential" nsamples="1" sampling_method="cycles">
                    <action device="phidget" full_name="fullname_4" tag="StartDeviceIO" type="start_device_io"></action>
                    <action device="NE500" full_name="fullname_4" tag="StartDeviceIO2" type="start_device_io"></action>
                    <list tag="IVP Random Shapes List" full_name="List of Random geometrical shapes" description="Randomly sample a task system in which one of the many possible geometrical shapes is used" interruptible="YES" selection="random_with_replacement" nsamples="5000" sampling_method="cycles">
                        <range_replicator tag="IVP Loop on Geometrical Shapes" full_name="fullname_9" from="0" to="1" step="1" variable="ImageIndex">
                            <task_system tag="Initiate VIsual Pres Task" full_name="fullname_6" description="" interruptible="YES">
                                <task_system_state tag="IVP Initialize" full_name="fullname_10" description="Initialize the current trial" interruptible="YES">
                                    <action tag="Initialize FlagAddFreeRewardToEarnedReward to 1" full_name="fullname_2" type="assignment" variable="FlagAddFreeRewardToEarnedReward" value="1"></action>
                                    <action tag="Initialize FlagDiscardCurrStim to 0" full_name="fullname_2" type="assignment" variable="FlagDiscardCurrStim" value="0"></action>
                                    <action type="if" tag="if FlagAutomaticBiasSuppression" condition="FlagAutomaticBiasSuppression == 1">
                                        <action type="if" tag="if task strategy is biased" condition="abs(Metric_Biased_Strategy) > Adjusted_Metric_Correct_Strategy">
                                            <action full_name="fullname_6" message=">>>>>> STRATEGY IS BIASED!!" tag="Report" type="report"></action>
                                            <action type="if" tag="if bias is to the left" condition="Metric_Biased_Strategy &lt; 0">
                                                <action type="assignment" tag="enable right stimulus presentation" variable="FlagShowStimRight" value="1"></action>
                                                <action type="assignment" tag="disable left stimulus presentation" variable="FlagShowStimLeft" value="0"></action>
                                            </action>
                                            <action type="if" tag="if bias is to the right" condition="Metric_Biased_Strategy > 0">
                                                <action type="assignment" tag="disable right stimulus presentation" variable="FlagShowStimRight" value="0"></action>
                                                <action type="assignment" tag="enable left stimulus presentation" variable="FlagShowStimLeft" value="1"></action>
                                            </action>
                                        </action>
                                        <action type="if" tag="if task strategy is NOT biased" condition="abs(Metric_Biased_Strategy) #LE Adjusted_Metric_Correct_Strategy">
                                            <action type="assignment" tag="enable left stimulus presentation" variable="FlagShowStimLeft" value="1"></action>
                                            <action type="assignment" tag="enable right stimulus presentation" variable="FlagShowStimRight" value="1"></action>
                                        </action>
                                    </action>
                                    <action type="if" tag="If do not show right stim" condition="FlagShowStimRight == 0">
                                        <action type="if" tag="if this is the right stimulus" condition="ImageIndex == 0">
                                            <action type="if" tag="If discarding right stimulus is allowed" condition="FlagAlwaysEnforceMaxSeqLeng == 0 #OR (FlagAlwaysEnforceMaxSeqLeng == 1 #AND LeftStim_Counter #LT MaxN_IdenticalStims)">
                                                <action full_name="fullname_6" message="Discard right stimulus ..." tag="Report" type="report"></action>
                                                <action tag="set FlagDiscardCurrStim to 1" full_name="fullname_2" type="assignment" variable="FlagDiscardCurrStim" value="1"></action>
                                            </action>
                                        </action>
                                    </action>
                                    <action type="if" tag="If do not show left stim" condition="FlagShowStimLeft == 0">
                                        <action type="if" tag="if this is the left stimulus" condition="ImageIndex == 1">
                                            <action type="if" tag="If discarding left stimulus is allowed" condition="FlagAlwaysEnforceMaxSeqLeng == 0 #OR (FlagAlwaysEnforceMaxSeqLeng == 1 #AND RightStim_Counter #LT MaxN_IdenticalStims)">
                                                <action full_name="fullname_6" message="Discard left stimulus ..." tag="Report" type="report"></action>
                                                <action tag="set FlagDiscardCurrStim to 1" full_name="fullname_2" type="assignment" variable="FlagDiscardCurrStim" value="1"></action>
                                            </action>
                                        </action>
                                    </action>
                                    <action tag="If FlagStaircaseHorizSeparation" full_name="fullname_4" type="if" condition="FlagStaircaseHorizSeparation == 1">
                                        <action tag="Set the abs_x_pos to current value given by the staircase" full_name="fullname_23" type="assignment" variable="abs_stm_pos_x" value="deg_HorizSep_current"></action>
                                    </action>
                                    <action full_name="fullname_6" message="Initialize IVP trial ..." tag="Report" type="report"></action>
                                    <action tag="CheckForBlockedTrialTime" full_name="fullname_1" type="start_timer" timer="CheckForBlockedTrialTimer" duration="CheckForBlockedTrialDuration" timebase=""></action>
                                    <transition tag="If too many identical stims in a row" full_name="fullname_13" target="IVP Finish" type="conditional" condition="FlagRepeatedTrial == 0 #AND ((FlagShowStimRight == 1 #AND FlagShowStimLeft == 1) #OR FlagAlwaysEnforceMaxSeqLeng == 1) #AND ( (ImageIndex == 0 #AND RightStim_Counter #GE MaxN_IdenticalStims) #OR (ImageIndex == 1 #AND LeftStim_Counter #GE MaxN_IdenticalStims) )"></transition>
                                    <transition tag="If trial contains NOT allowed stimulus" full_name="fullname_3" target="IVP Finish" type="conditional" condition="FlagDiscardCurrStim == 1"></transition>
                                    <transition tag="If already licking..." full_name="fullname_11" target="IVP Block Trial" type="conditional" condition="LickInput1 #GT 800 #OR LickInput3 #GT 800"></transition>
                                    <transition tag="if Timer Expired..." full_name="fullname_3" target="IVP Wait For Trigger Trial" type="timer_expired" timer="CheckForBlockedTrialTimer"></transition>
                                </task_system_state>
                                <task_system_state tag="IVP Block Trial" full_name="Block Trial" description="Block current trial is rat is licking before the starting tone" interruptible="YES">
                                    <action full_name="fullname_6" message="Block the trial ..." tag="Report" type="report"></action>
                                    <action duration="BlockTrial_time" full_name="fullname_15" tag="Start Block Trial Timer" timer="BlockTrial_timer" type="start_timer" timebase=""></action>
                                    <transition tag="If Timer Expired..." full_name="fullname_18" target="IVP Initialize" type="timer_expired" timer="BlockTrial_timer"></transition>
                                </task_system_state>
                                <task_system_state tag="IVP Wait For Trigger Trial" full_name="fullname_10" description="Initialize the current trial" interruptible="YES">
                                    <action full_name="fullname_6" message="Wait for animal triggering the trial ..." tag="Report" type="report"></action>
                                    <action tag="Start Wait For Trigger Timer" full_name="fullname_1" type="start_timer" timer="WaitForTrigger_timer" duration="WaitForTrigger_time" timebase=""></action>
                                    <transition tag="If touching trigger port and allowed stimulus" full_name="fullname_11" target="IVP Pre-show stimulus" type="conditional" condition="LickInput2 #GT 500"></transition>
                                    <transition tag="If already licking..." full_name="fullname_11" target="IVP Block Trial" type="conditional" condition="LickInput1 #GT 500 #OR LickInput3 #GT 500"></transition>
                                    <transition tag="if Timer Expired..." full_name="fullname_3" target="IVP Wait For Trigger Trial" type="timer_expired" timer="WaitForTrigger_timer"></transition>
                                </task_system_state>
                                <task_system_state tag="IVP Pre-show stimulus" full_name="fullname_10" description="" interruptible="YES">
                                    <action tag="Announce start trial" full_name="fullname_10" type="assignment" variable="Announce_TrialStart" value="1"></action>
                                    <action tag="Start wait for trigger tone duration" full_name="fullname_1" type="start_timer" timer="WaitForTriggerToneDuration_timer" duration="WaitForTriggerToneDuration_time" timebase=""></action>
                                    <transition tag="If Timer Expired" full_name="fullname_13" target="IVP Show Stimulus" type="timer_expired" timer="WaitForTriggerToneDuration_timer"></transition>
                                </task_system_state>
                                <task_system_state tag="IVP Show Stimulus" full_name="fullname_1" description="" interruptible="YES">
                                    <action full_name="fullname_6" message="Triggered stimulus presentation... FlagRepeatedTrial: $FlagRepeatedTrial" tag="Report" type="report"></action>
                                    <action tag="If Shape # 1" full_name="fullname_11" type="if" condition="ImageIndex == 0">
                                        <action tag="Report" type="report" message="--- show SHAPE # 1" full_name=""></action>
                                        <action tag="set stm_pos_x" full_name="set stm_pos_x" type="assignment" variable="stm_pos_x" value="abs_stm_pos_x"></action>
                                        <action tag="set stm_pos_y" full_name="set stm_pos_y" type="assignment" variable="stm_pos_y" value="0"></action>
                                        <action tag="If NOT a Correction/repeated Trial" type="if" condition="FlagRepeatedTrial == 0" full_name="">
                                            <action tag="Report" type="report" message="... inside if: initialize stim counters" full_name=""></action>
                                            <action tag="Initialize to zero left stim counter" full_name="fullname_3" type="assignment" variable="LeftStim_Counter" value="0"></action>
                                            <action tag="Increment right stim counter" full_name="fullname_3" type="assignment" variable="RightStim_Counter" value="RightStim_Counter+1"></action>
                                        </action>
                                        <action tag="If cue stim with a reinforcement sound" full_name="fullname_2" type="if" condition="FlagCueStimSound == 1">
                                            <action tag="Report" type="report" message="... inside if: play cue stim sound" full_name=""></action>
                                            <action full_name="fullname_14" sound="StimRight" tag="Play right stimulus sound" type="play_sound"></action>
                                        </action>
                                        <action tag="If always reward" full_name="fullname_2" type="if" condition="FlagAlwaysReward == 1">
                                            <action tag="Sample a random number" full_name="fullname_10" type="assignment" variable="FreeRew_CurrRandSamp" value="rand(0,1)"></action>
                                            <action tag="Choose whether to give the free reward or not" full_name="fullname_2" type="if" condition="FreeRew_CurrRandSamp #LE p_FreeRew_current">
                                                <action tag="Initialize FlagAddFreeRewardToEarnedReward to 0" full_name="fullname_2" type="assignment" variable="FlagAddFreeRewardToEarnedReward" value="0"></action>
                                                <action full_name="fullname_17" tag="Give Reward" type="assignment" value="cue_reward_duration" variable="LickOutput3"></action>
                                                <action tag="Report" type="report" message="... inside if: ##### ATTENTION: gives free reward!!! ########" full_name=""></action>
                                            </action>
                                        </action>
                                    </action>
                                    <action tag="If Shape # 2" full_name="fullname_11" type="if" condition="ImageIndex == 1">
                                        <action tag="Report" type="report" message="--- show SHAPE # 2" full_name=""></action>
                                        <action tag="set stm_pos_x" full_name="set stm_pos_x" type="assignment" variable="stm_pos_x" value="-abs_stm_pos_x"></action>
                                        <action tag="set stm_pos_y" full_name="set stm_pos_y" type="assignment" variable="stm_pos_y" value="0"></action>
                                        <action tag="If NOT a Correction/repeated Trial" type="if" condition="FlagRepeatedTrial == 0" full_name="">
                                            <action tag="Report" type="report" message="... inside if: initialize stim counters" full_name=""></action>
                                            <action tag="Initialize to zero right stim counter" full_name="fullname_3" type="assignment" variable="RightStim_Counter" value="0"></action>
                                            <action tag="Increment left stim counter" full_name="fullname_3" type="assignment" variable="LeftStim_Counter" value="LeftStim_Counter+1"></action>
                                        </action>
                                        <action tag="If cue stim with a reinforcement sound" full_name="fullname_2" type="if" condition="FlagCueStimSound == 1">
                                            <action tag="Report" type="report" message="... inside if: play cue stim sound" full_name=""></action>
                                            <action full_name="fullname_14" sound="StimLeft" tag="Play left stimulus sound" type="play_sound"></action>
                                        </action>
                                        <action tag="If always reward" full_name="fullname_2" type="if" condition="FlagAlwaysReward == 1">
                                            <action tag="Sample a random number" full_name="fullname_10" type="assignment" variable="FreeRew_CurrRandSamp" value="rand(0,1)"></action>
                                            <action tag="Choose whether to give the free reward or not" full_name="fullname_2" type="if" condition="FreeRew_CurrRandSamp #LE p_FreeRew_current">
                                                <action tag="Initialize FlagAddFreeRewardToEarnedReward to 0" full_name="fullname_2" type="assignment" variable="FlagAddFreeRewardToEarnedReward" value="0"></action>
                                                <action full_name="fullname_17" tag="Give Reward" type="assignment" value="cue_reward_duration" variable="LickOutput1"></action>
                                                <action tag="Report" type="report" message="... inside if: ##### ATTENTION: gives free reward!!! ########" full_name=""></action>
                                            </action>
                                        </action>
                                    </action>
                                    <action tag="If show visual stimuli" type="if" condition="FlagShowVisualStimuli == 1" full_name="">
                                        <action tag="queue background" full_name="queue stm" type="queue_stimulus" stimulus="BlankScreen"></action>
                                        <action tag="queue stm" full_name="queue stm" type="queue_stimulus" stimulus="Stimulus_Set[ImageIndex]"></action>
                                        <action tag="Announce stim on" full_name="fullname_10" type="assignment" variable="Announce_StimOn" value="1"></action>
                                        <action tag="show stm" full_name="show stm" type="update_stimulus_display"></action>
                                    </action>
                                    <action duration="StimulusPresentation_time - CueStimSoundPresentation_time" full_name="fullname_15" tag="Start Stim Duration Timer" timer="StimulusPresentation_timer" type="start_timer" timebase=""></action>
                                    <action duration="CueStimSoundPresentation_time" full_name="fullname_15" tag="Start Sound Duration Timer" timer="CueStimSoundPresentation_timer" type="start_timer" timebase=""></action>
                                    <action duration="TooFast_time" full_name="fullname_15" tag="Start TooFast Timer" timer="TooFast_timer" type="start_timer" timebase=""></action>
                                    <transition tag="if Lick Port 1 or 3" full_name="fullname_1" target="IVP Aborted" type="conditional" condition="LickInput1 #GT 500 #OR LickInput3 #GT 500"></transition>
                                    <transition tag="if Too Fast timer expired" full_name="fullname_6" target="IVP Keep playing sound" type="timer_expired" timer="TooFast_timer"></transition>
                                </task_system_state>
                                <task_system_state tag="IVP Keep playing sound" full_name="fullname_1" description="" interruptible="YES">
                                    <action full_name="fullname_6" message="Keep playing sound ..." tag="Report" type="report"></action>
                                    <transition tag="if Lick Port 1" full_name="fullname_1" target="IVP Acquire Port 1" type="conditional" condition="LickInput1 #GT 500"></transition>
                                    <transition tag="if Lick Port 3" full_name="fullname_3" target="IVP Acquire Port 3" type="conditional" condition="LickInput3 #GT 500"></transition>
                                    <transition tag="If Sound Duration Timer Expired" full_name="fullname_15" target="IVP Keep stim ON after cue sound offset" type="timer_expired" timer="CueStimSoundPresentation_timer"></transition>
                                </task_system_state>
                                <task_system_state tag="IVP Keep stim ON after cue sound offset" full_name="fullname_1" description="" interruptible="YES">
                                    <action full_name="fullname_6" message="Keep showing stimulus after sound offset ..." tag="Report" type="report"></action>
                                    <action tag="Stop right stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimRight"></action>
                                    <action tag="Stop left stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimLeft"></action>
                                    <transition tag="if Lick Port 1" full_name="fullname_1" target="IVP Acquire Port 1" type="conditional" condition="LickInput1 #GT 500"></transition>
                                    <transition tag="if Lick Port 3" full_name="fullname_3" target="IVP Acquire Port 3" type="conditional" condition="LickInput3 #GT 500"></transition>
                                    <transition tag="If Timer Expired" full_name="fullname_15" target="IVP Stimulus Off" type="timer_expired" timer="StimulusPresentation_timer"></transition>
                                </task_system_state>
                                <task_system_state tag="IVP Stimulus Off" full_name="fullname_12" description="" interruptible="YES">
                                    <action tag="dequeue stm" full_name="dequeue stm" type="dequeue_stimulus" stimulus="Stimulus_Set[ImageIndex]"></action>
                                    <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                    <action tag="Announce stim off" full_name="fullname_10" type="assignment" variable="Announce_StimOff" value="1"></action>
                                    <action duration="acquire_time - StimulusPresentation_time" full_name="fullname_15" tag="Start Acquire Timer" timer="acquire_timer" type="start_timer" timebase=""></action>
                                    <transition condition="LickInput1 #GT 500" full_name="fullname_25" tag="If Lick Port 1" target="IVP Acquire Port 1" type="conditional"></transition>
                                    <transition tag="if Lick Port 3" full_name="fullname_4" target="IVP Acquire Port 3" type="conditional" condition="LickInput3 #GT 500"></transition>
                                    <transition tag="If Timer Expired" full_name="fullname_1" target="IVP Ignored" type="timer_expired" timer="acquire_timer"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="Acquire State" interruptible="YES" tag="IVP Acquire Port 1">
                                    <action tag="Announce trigger port 1" full_name="fullname_10" type="assignment" variable="Announce_AcquirePort1" value="1"></action>
                                    <action full_name="fullname_6" message="Response Acquired on Port 1 ..." tag="Report" type="report"></action>
                                    <action tag="Stop left stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimLeft"></action>
                                    <action tag="Stop right stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimRight"></action>
                                    <action type="assignment" tag="Set WatchResponseSide to -1 (LEFT port)" variable="WatchResponseSide" value="-1"></action>
                                    <transition tag="Correct Response" full_name="fullname_6" target="IVP Pre-Reward Port 1" type="conditional" condition="ImageIndex == 1"></transition>
                                    <transition tag="Wrong Response" full_name="fullname_7" target="IVP Failure" type="conditional" condition="ImageIndex == 0"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="Acquire State" interruptible="YES" tag="IVP Pre-Reward Port 1">
                                    <action full_name="fullname_6" message="Pre-Reward Port 1 ..." tag="Report" type="report"></action>
                                    <action tag="If don't display stim after response" full_name="fullname_1" type="if" condition="FlagShowStimAfterResponse == 0">
                                        <action tag="If_2" type="if" condition="1" full_name=""></action>
                                        <action tag="dequeue stm" full_name="dequeue stm" type="dequeue_stimulus" stimulus="Stimulus_Set[ImageIndex]"></action>
                                        <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                        <action tag="Announce stim off" full_name="fullname_10" type="assignment" variable="Announce_StimOff" value="1"></action>
                                    </action>
                                    <action tag="If play outcome sound" type="if" condition="FlagPlayOutcomeSound == 1" full_name=""></action>
                                    <action tag="Update success" full_name="fullname_6" type="assignment" variable="success" value="1"></action>
                                    <action tag="If always reward" full_name="fullname_2" type="if" condition="FlagAlwaysReward == 1">
                                        <action tag="If staircase prob free reward is active" full_name="fullname_4" type="if" condition="FlagStaircaseProbFreeRew ==1">
                                            <action tag="Update WatchSuccessStair_FreeRew" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_FreeRew" value="1"></action>
                                        </action>
                                    </action>
                                    <action tag="If FlagStaircaseHorizSeparation" full_name="fullname_4" type="if" condition="FlagStaircaseHorizSeparation == 1">
                                        <action tag="Update WatchSuccessStair_FreeRew" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_HorizSep" value="1"></action>
                                    </action>
                                    <action tag="Update WatchSuccessBias" full_name="fullname_6" type="assignment" variable="WatchSuccessBias" value="1"></action>
                                    <action duration="prestim_time" full_name="fullname_16" tag="Start PreStim Timer" timer="prestim_timer" type="start_timer" timebase=""></action>
                                    <transition full_name="fullname_21" tag="If Timer Expired..." target="IVP Reward Port 1" timer="prestim_timer" type="timer_expired"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="fullname_11" interruptible="YES" tag="IVP Reward Port 1">
                                    <action full_name="fullname_6" message="REWARD!" tag="Report" type="report"></action>
                                    <action tag="If reward more than maximum allowed" full_name="fullname_21" type="if" condition="reward_duration #GT maximal_reward_duration">
                                        <action full_name="fullname_6" message="reset reward to maximum!" tag="Report" type="report"></action>
                                        <action tag="reset reward to maximum" full_name="fullname_20" type="assignment" variable="reward_duration" value="maximal_reward_duration"></action>
                                    </action>
                                    <action tag="Set current reward duration" full_name="fullname_7" type="assignment" variable="curr_reward_duration" value="reward_duration + (FlagAddFreeRewardToEarnedReward* FlagAlwaysReward*cue_reward_duration)"></action>
                                    <action full_name="fullname_17" tag="Give Reward" type="assignment" value="curr_reward_duration" variable="LickOutput1"></action>
                                    <action tag="If play outcome sound" type="if" condition="FlagPlayOutcomeSound == 1" full_name="">
                                        <action full_name="fullname_31" sound="RewardSound" tag="Play Reward Tone" type="play_sound"></action>
                                    </action>
                                    <transition full_name="fullname_23" tag="Goto Licking Time" target="IVP Additional Licking Time" type="direct"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="Acquire State" interruptible="YES" tag="IVP Acquire Port 3">
                                    <action tag="Announce trigger port 3" full_name="fullname_10" type="assignment" variable="Announce_AcquirePort3" value="1"></action>
                                    <action full_name="fullname_6" message="Response Acquired on Port 3 ..." tag="Report" type="report"></action>
                                    <action tag="Stop left stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimLeft"></action>
                                    <action tag="Stop right stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimRight"></action>
                                    <action type="assignment" tag="Set WatchResponseSide to 1 (RIGHT port)" variable="WatchResponseSide" value="1"></action>
                                    <transition tag="Correct Response" full_name="fullname_8" target="IVP Pre-Reward Port 3" type="conditional" condition="ImageIndex == 0"></transition>
                                    <transition tag="Wrong Response" full_name="fullname_9" target="IVP Failure" type="conditional" condition="ImageIndex == 1"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="Acquire State" interruptible="YES" tag="IVP Pre-Reward Port 3">
                                    <action full_name="fullname_6" message="Response Acquired ..." tag="Pre-Reward Port 3" type="report"></action>
                                    <action tag="If don't display stim after response" full_name="fullname_1" type="if" condition="FlagShowStimAfterResponse == 0">
                                        <action tag="dequeue stm" full_name="dequeue stm" type="dequeue_stimulus" stimulus="Stimulus_Set[ImageIndex]"></action>
                                        <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                        <action tag="Announce stim off" full_name="fullname_10" type="assignment" variable="Announce_StimOff" value="1"></action>
                                    </action>
                                    <action tag="If play outcome sound" type="if" condition="FlagPlayOutcomeSound == 1" full_name=""></action>
                                    <action tag="Update success" full_name="fullname_6" type="assignment" variable="success" value="1"></action>
                                    <action tag="If always reward" full_name="fullname_2" type="if" condition="FlagAlwaysReward == 1">
                                        <action tag="If staircase prob free reward is active" full_name="fullname_4" type="if" condition="FlagStaircaseProbFreeRew ==1">
                                            <action tag="Update WatchSuccessStair_FreeRew" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_FreeRew" value="1"></action>
                                        </action>
                                    </action>
                                    <action tag="If FlagStaircaseHorizSeparation" full_name="fullname_4" type="if" condition="FlagStaircaseHorizSeparation == 1">
                                        <action tag="Update WatchSuccessStair_FreeRew" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_HorizSep" value="1"></action>
                                    </action>
                                    <action tag="Update WatchSuccessBias" full_name="fullname_6" type="assignment" variable="WatchSuccessBias" value="1"></action>
                                    <action duration="prestim_time" full_name="fullname_16" tag="Start PreStim Timer" timer="prestim_timer" type="start_timer" timebase=""></action>
                                    <transition full_name="fullname_21" tag="If Timer Expired..." target="IVP Reward Port 3" timer="prestim_timer" type="timer_expired"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="fullname_11" interruptible="YES" tag="IVP Reward Port 3">
                                    <action full_name="fullname_6" message="REWARD!" tag="Report" type="report"></action>
                                    <action tag="If reward more than maximum allowed" full_name="fullname_21" type="if" condition="reward_duration #GT maximal_reward_duration">
                                        <action full_name="fullname_6" message="reset reward to maximum!" tag="Report" type="report"></action>
                                        <action tag="reset reward to maximum" full_name="fullname_20" type="assignment" variable="reward_duration" value="maximal_reward_duration"></action>
                                    </action>
                                    <action tag="Set current reward duration" full_name="fullname_7" type="assignment" variable="curr_reward_duration" value="reward_duration + (FlagAddFreeRewardToEarnedReward* FlagAlwaysReward*cue_reward_duration)"></action>
                                    <action full_name="fullname_17" tag="Give Reward" type="assignment" value="curr_reward_duration" variable="LickOutput3"></action>
                                    <action tag="If play outcome sound" type="if" condition="FlagPlayOutcomeSound == 1" full_name="">
                                        <action full_name="fullname_31" sound="RewardSound" tag="Play Reward Tone" type="play_sound"></action>
                                    </action>
                                    <transition full_name="fullname_23" tag="Goto Licking Time" target="IVP Additional Licking Time" type="direct"></transition>
                                </task_system_state>
                                <task_system_state tag="IVP Additional Licking Time" full_name="fullname_1" description="" interruptible="YES">
                                    <action full_name="fullname_6" message="Give additional Licking time ..." tag="Report" type="report"></action>
                                    <action tag="If reward less than maximum allowed" full_name="fullname_21" type="if" condition="reward_duration #LT maximal_reward_duration">
                                        <action tag="Increment reward" full_name="fullname_20" type="assignment" variable="reward_duration" value="reward_duration + increment_reward_duration"></action>
                                    </action>
                                    <action duration="licking_time" full_name="fullname_16" tag="Start licking Timer" timer="licking_timer" type="start_timer" timebase=""></action>
                                    <transition tag="If Timer Expired ..." full_name="fullname_5" target="IVP Idle" type="timer_expired" timer="licking_timer"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="fullname_12" interruptible="YES" tag="IVP Failure">
                                    <action full_name="fullname_6" message="Failed..." tag="Report" type="report"></action>
                                    <action tag="Initialize reward to minimum" full_name="fullname_20" type="assignment" variable="reward_duration" value="minimal_reward_duration"></action>
                                    <action tag="Initialize punishment cycle index" full_name="fullname_19" type="assignment" variable="PunishmentCyclesIndex" value="0"></action>
                                    <action tag="If play outcome sound" type="if" condition="FlagPlayOutcomeSound == 1" full_name="">
                                        <action full_name="fullname_31" sound="FailureSound2" tag="Play Failure Tone" type="play_sound"></action>
                                    </action>
                                    <action tag="Update failure" full_name="fullname_6" type="assignment" variable="failure" value="1"></action>
                                    <action tag="If always reward" full_name="fullname_2" type="if" condition="FlagAlwaysReward == 1">
                                        <action tag="If staircase prob free reward is active" full_name="fullname_4" type="if" condition="FlagStaircaseProbFreeRew ==1">
                                            <action tag="Update WatchSuccessStair_FreeRew" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_FreeRew" value="0"></action>
                                        </action>
                                    </action>
                                    <action tag="If FlagStaircaseHorizSeparation" full_name="fullname_4" type="if" condition="FlagStaircaseHorizSeparation == 1">
                                        <action tag="Update WatchSuccessStair_FreeRew" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_HorizSep" value="0"></action>
                                    </action>
                                    <action tag="Update WatchSuccessBias" full_name="fullname_6" type="assignment" variable="WatchSuccessBias" value="0"></action>
                                    <action tag="dequeue stm" full_name="dequeue stm" type="dequeue_stimulus" stimulus="Stimulus_Set[ImageIndex]"></action>
                                    <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                    <action tag="Announce stim off" full_name="fullname_10" type="assignment" variable="Announce_StimOff" value="1"></action>
                                    <transition tag="Go into Punishment Loop" full_name="fullname_2" target="IVP Punishment Loop Gray" type="conditional" condition="FlagLongPunishment == 1"></transition>
                                    <transition tag="Goto Idle" full_name="fullname_3" target="IVP Idle" type="conditional" condition="FlagLongPunishment == 0"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="fullname_12" interruptible="YES" tag="IVP Punishment Loop Gray">
                                    <action full_name="fullname_6" message="Failed: punish with gray background" tag="Report" type="report"></action>
                                    <action full_name="fullname_31" sound="FailureSound" tag="Play Failure Tone" type="play_sound"></action>
                                    <action tag="queue gray background" full_name="queue stm" type="queue_stimulus" stimulus="BlankScreenGray"></action>
                                    <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                    <action duration="backgr_punish_flickering_period" full_name="fullname_16" tag="Start gray background Timer" timer="background_timer" type="start_timer" timebase=""></action>
                                    <transition tag="If Timer Expired ..." full_name="fullname_14" target="IVP Punishment Loop Black" type="timer_expired" timer="background_timer"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="fullname_12" interruptible="YES" tag="IVP Punishment Loop Black">
                                    <action full_name="fullname_6" message="Failed: punish with black background pc: $PunishmentCyclesIndex npc: $N_PunishmentCycles" tag="Report" type="report"></action>
                                    <action tag="Update punishment cycle index" full_name="fullname_19" type="assignment" variable="PunishmentCyclesIndex" value="PunishmentCyclesIndex + 1"></action>
                                    <action full_name="fullname_31" sound="FailureSound2" tag="Play Failure Tone" type="play_sound"></action>
                                    <action tag="dequeue gray background" full_name="dequeue stm" type="dequeue_stimulus" stimulus="BlankScreenGray"></action>
                                    <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                    <action duration="backgr_punish_flickering_period" full_name="fullname_16" tag="Start black background Timer" timer="background_timer" type="start_timer" timebase=""></action>
                                    <transition tag="Repeat current trial as a correction" full_name="fullname_1" target="IVP Prepare for correction trial" type="conditional" condition="PunishmentCyclesIndex #GT N_PunishmentCycles #AND FlagCorrectionTrials == 1"></transition>
                                    <transition tag="Exit loop and jump to Idle" full_name="fullname_17" target="IVP Idle" type="conditional" condition="PunishmentCyclesIndex #GT N_PunishmentCycles #AND FlagCorrectionTrials == 0"></transition>
                                    <transition tag="If Timer Expired ..." full_name="fullname_24" target="IVP Punishment Loop Gray" type="timer_expired" timer="background_timer"></transition>
                                </task_system_state>
                                <task_system_state tag="IVP Prepare for correction trial" description="" interruptible="YES" full_name="">
                                    <action full_name="fullname_6" message="... Prepare for CORRECTIO TRIAL. FlagRepeatedTrial: $FlagRepeatedTrial" tag="Report" type="report"></action>
                                    <action tag="Signal that the next will be a correction trial" type="assignment" variable="FlagRepeatedTrial" value="1" full_name=""></action>
                                    <action full_name="fullname_6" message=".... FlagRepeatedTrial changed to: $FlagRepeatedTrial" tag="Report" type="report"></action>
                                    <transition tag="Go back to initialize" target="IVP Initialize" type="direct" full_name=""></transition>
                                </task_system_state>
                                <task_system_state tag="IVP Aborted" full_name="fullname_7" description="" interruptible="YES">
                                    <action full_name="fullname_6" message="Aborted ..." tag="Report" type="report"></action>
                                    <action tag="If play outcome sound" type="if" condition="FlagPlayOutcomeSound == 1" full_name="">
                                        <action full_name="fullname_31" sound="FailureSound2" tag="Play Failure Tone" type="play_sound"></action>
                                    </action>
                                    <action tag="Initialize reward to minimum" full_name="fullname_20" type="assignment" variable="reward_duration" value="minimal_reward_duration"></action>
                                    <action tag="Stop left stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimLeft"></action>
                                    <action tag="Stop right stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimRight"></action>
                                    <action tag="dequeue stm" full_name="dequeue stm" type="dequeue_stimulus" stimulus="Stimulus_Set[ImageIndex]"></action>
                                    <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                    <action tag="Announce stim off" full_name="fullname_10" type="assignment" variable="Announce_StimOff" value="1"></action>
                                    <transition tag="AlwaysGo to Idle" full_name="fullname_14" target="IVP Idle" type="direct"></transition>
                                </task_system_state>
                                <task_system_state tag="IVP Ignored" full_name="fullname_11" description="" interruptible="YES">
                                    <action full_name="fullname_6" message="Ignored ..." tag="Report" type="report"></action>
                                    <action tag="Update ignored" full_name="fullname_6" type="assignment" variable="ignore" value="1"></action>
                                    <transition tag="AlwaysGo to Idle" full_name="fullname_13" target="IVP Idle" type="direct"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="fullname_13" interruptible="YES" tag="IVP Idle">
                                    <action full_name="fullname_6" message="idling..." tag="Report" type="report"></action>
                                    <action tag="dequeue stm" full_name="dequeue stm" type="dequeue_stimulus" stimulus="Stimulus_Set[ImageIndex]"></action>
                                    <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                    <action tag="Announce stim off" full_name="fullname_10" type="assignment" variable="Announce_StimOff" value="1"></action>
                                    <action tag="Announce end trial" full_name="fullname_10" type="assignment" variable="Announce_TrialEnd" value="1"></action>
                                    <action duration="intertrial_interval" full_name="fullname_19" tag="Start Idle Timer" timer="idle_timer" type="start_timer" timebase=""></action>
                                    <transition full_name="fullname_20" tag="If Timer Expired..." target="IVP Finish" timer="idle_timer" type="timer_expired"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="fullname_3" interruptible="YES" tag="IVP Finish">
                                    <action full_name="fullname_6" message="Yielding ..." tag="Report" type="report"></action>
                                    <action tag="Reset Flag telling the next is a correction trial to zero" full_name="fullname_10" type="assignment" variable="FlagRepeatedTrial" value="0"></action>
                                    <action type="assignment" tag="Compute the Adjusted_Metric_Correct_Strategy" variable="Adjusted_Metric_Correct_Strategy" value="GainFactorCorrectMetric * Metric_Correct_Strategy"></action>
                                    <action full_name="fullname_6" message="Reset FlagRepeatedTrial to $FlagRepeatedTrial" tag="Report" type="report"></action>
                                    <action tag="Reset Announce trial no feedback to zero" full_name="fullname_10" type="assignment" variable="Announce_TrialNoFeedback" value="0"></action>
                                    <action tag="Reset Announce start trial to zero" full_name="fullname_10" type="assignment" variable="Announce_TrialStart" value="0"></action>
                                    <action tag="Reset Announce end trial to zero" full_name="fullname_10" type="assignment" variable="Announce_TrialEnd" value="0"></action>
                                    <action tag="Reset Announce stim on to zero" full_name="fullname_10" type="assignment" variable="Announce_StimOn" value="0"></action>
                                    <action tag="Reset Announce stim off to zero" full_name="fullname_10" type="assignment" variable="Announce_StimOff" value="0"></action>
                                    <action tag="Reset Announce acquire port 1 to zero" full_name="fullname_10" type="assignment" variable="Announce_AcquirePort1" value="0"></action>
                                    <action tag="Reset Announce acquire port 3 to zero" full_name="fullname_10" type="assignment" variable="Announce_AcquirePort3" value="0"></action>
                                    <action tag="Reset Announce trial no feedback to zero" full_name="fullname_10" type="assignment" variable="Announce_TrialNoFeedback" value="0"></action>
                                    <transition full_name="fullname_5" tag="Yield" type="yield" target="~STATE_REF~"></transition>
                                </task_system_state>
                            </task_system>
                        </range_replicator>
                    </list>
                    <action device="phidget" full_name="fullname_5" tag="StopDeviceIO" type="stop_device_io"></action>
                    <action device="NE500" full_name="fullname_5" tag="StopDeviceIO2" type="stop_device_io"></action>
                </trial>
            </block>
        </protocol>
        <protocol tag="Staircase through shape parameters" full_name="fullname_1" description="" interruptible="YES" selection="sequential" nsamples="1" sampling_method="cycles">
            <block tag="Staircase Block" full_name="fullname_2" description="" interruptible="YES" selection="sequential" nsamples="1" sampling_method="cycles">
                <trial tag="Staircase Trial" full_name="fullname_3" description="" interruptible="YES" selection="sequential" nsamples="1" sampling_method="cycles">
                    <action device="phidget" full_name="fullname_4" tag="StartDeviceIO3" type="start_device_io"></action>
                    <action device="NE500" full_name="fullname_4" tag="StartDeviceIO4" type="start_device_io"></action>
                    <list tag="Staircase Random Shapes List" full_name="List of Random geometrical shapes" description="Randomly sample a task system in which one of the many possible geometrical shapes is used" interruptible="YES" selection="random_with_replacement" nsamples="5000" sampling_method="cycles">
                        <range_replicator tag="Staircase Loop on Geometrical Shapes" full_name="fullname_9" from="0" to="1" step="1" variable="ImageIndex">
                            <task_system tag="Staircase Task" full_name="fullname_6" description="" interruptible="YES">
                                <task_system_state tag="IVP Initialize" full_name="fullname_10" description="Initialize the current trial" interruptible="YES">
                                    <action full_name="fullname_6" message="Initialize IVP trial ..." tag="Report" type="report"></action>
                                    <action tag="Initialize FlagDiscardCurrStim to 0" full_name="fullname_2" type="assignment" variable="FlagDiscardCurrStim" value="0"></action>
                                    <action type="if" tag="if FlagAutomaticBiasSuppression" condition="FlagAutomaticBiasSuppression == 1">
                                        <action type="if" tag="if task strategy is biased" condition="abs(Metric_Biased_Strategy) > Adjusted_Metric_Correct_Strategy">
                                            <action full_name="fullname_6" message=">>>>>> STRATEGY IS BIASED!!" tag="Report" type="report"></action>
                                            <action type="if" tag="if bias is to the left" condition="Metric_Biased_Strategy &lt; 0">
                                                <action type="assignment" tag="enable right stimulus presentation" variable="FlagShowStimRight" value="1"></action>
                                                <action type="assignment" tag="disable left stimulus presentation" variable="FlagShowStimLeft" value="0"></action>
                                            </action>
                                            <action type="if" tag="if bias is to the right" condition="Metric_Biased_Strategy > 0">
                                                <action type="assignment" tag="disable right stimulus presentation" variable="FlagShowStimRight" value="0"></action>
                                                <action type="assignment" tag="enable left stimulus presentation" variable="FlagShowStimLeft" value="1"></action>
                                            </action>
                                        </action>
                                        <action type="if" tag="if task strategy is NOT biased" condition="abs(Metric_Biased_Strategy) #LE Adjusted_Metric_Correct_Strategy">
                                            <action type="assignment" tag="enable left stimulus presentation" variable="FlagShowStimLeft" value="1"></action>
                                            <action type="assignment" tag="enable right stimulus presentation" variable="FlagShowStimRight" value="1"></action>
                                        </action>
                                    </action>
                                    <action tag="Choose the current staircase trial type" full_name="fullname_10" type="assignment" variable="CurrStairTrial" value="disc_rand(1, N_Staircases)"></action>
                                    <action tag="If force two thirds of trials to be rotations" full_name="" type="if" condition="Flag_two_third_trials_Rotation == 1">
                                        <action full_name="fullname_6" message="Current Third = $CurrThird" tag="Report" type="report"></action>
                                        <action tag="Choose the current third" full_name="fullname_10" type="assignment" variable="CurrThird" value="disc_rand(1,3)"></action>
                                        <action tag="If first third" full_name="fullname_19" type="if" condition="CurrThird == 1">
                                            <action tag="Curr trial is Rotation CW" full_name="fullname_20" type="assignment" variable="CurrStairTrial" value="6"></action>
                                        </action>
                                        <action tag="If second third" full_name="fullname_19" type="if" condition="CurrThird == 2">
                                            <action tag="Curr trial is Rotation ACW" full_name="fullname_20" type="assignment" variable="CurrStairTrial" value="7"></action>
                                        </action>
                                        <action tag="If last third" full_name="fullname_19" type="if" condition="CurrThird == 3">
                                            <action tag="Curr trial is NOT rotation" full_name="fullname_20" type="assignment" variable="CurrStairTrial" value="disc_rand(1, N_Staircases-2)"></action>
                                        </action>
                                    </action>
                                    <action tag="Initilaize Flag_MatchCurrStairTrial" full_name="fullname_23" type="assignment" variable="Flag_MatchCurrStairTrial" value="0"></action>
                                    <action tag="if Staircase size" full_name="fullname_16" type="if" condition="(FlagStaircaseSize == 1 #OR FlagStaircaseSize == -1) #AND CurrStairTrial == 1">
                                        <action full_name="fullname_6" message="####### Staircase ---> SIZE" tag="Report" type="report"></action>
                                        <action tag="Set Flag_MatchCurrStairTrial to true" full_name="fullname_23" type="assignment" variable="Flag_MatchCurrStairTrial" value="1"></action>
                                        <action tag="Sample stim size within allowed range" full_name="fullname_10" type="assignment" variable="stm_size" value="initial_size_stair + size_stair_step * (N_sizes_stair_current - geom_rand(p_GeomDistr_stair_size, N_sizes_stair_current))"></action>
                                        <action tag="Compute stim size current range limit" full_name="fullname_10" type="assignment" variable="current_size_limit_stair" value="initial_size_stair + size_stair_step * N_sizes_stair_current"></action>
                                        <action tag="Set stm_pos_x to default" full_name="fullname_21" type="assignment" variable="stm_pos_x" value="Default_PosH"></action>
                                        <action tag="Set stm_pos_y to default" full_name="fullname_21" type="assignment" variable="stm_pos_y" value="Default_PosV"></action>
                                        <action tag="Set stm_rotation to default" full_name="fullname_21" type="assignment" variable="stm_rotation" value="Default_Rotation"></action>
                                        <action tag="If sample from uniform distribution" full_name="fullname_2" type="if" condition="FlagSampUniformDistr == 1">
                                            <action full_name="fullname_6" message="Sample from uniform distribution ..." tag="Report" type="report"></action>
                                            <action tag="Sample stim size within allowed range" full_name="fullname_10" type="assignment" variable="stm_size" value="initial_size_stair + size_stair_step * disc_rand(0, N_sizes_stair_current)"></action>
                                        </action>
                                    </action>
                                    <action tag="if Staircase Pos HR" full_name="fullname_16" type="if" condition="(FlagStaircasePosHR == 1 #OR FlagStaircasePosHR == -1) #AND CurrStairTrial == 2">
                                        <action full_name="fullname_6" message="####### Staircase ---> POSITION HORIZONTAL RIGHT" tag="Report" type="report"></action>
                                        <action tag="Set Flag_MatchCurrStairTrial to true" full_name="fullname_23" type="assignment" variable="Flag_MatchCurrStairTrial" value="1"></action>
                                        <action tag="Sample stim Pos HR within allowed range" full_name="fullname_10" type="assignment" variable="stm_pos_x" value="initial_PosHR_stair + PosHR_stair_step * (N_PosHR_stair_current - geom_rand(p_GeomDistr_stair_PosHR, N_PosHR_stair_current))"></action>
                                        <action tag="Compute stim Pos HR current range limit" full_name="fullname_10" type="assignment" variable="current_PosHR_limit_stair" value="initial_PosHR_stair + PosHR_stair_step * N_PosHR_stair_current"></action>
                                        <action tag="Set stm_size to default" full_name="fullname_21" type="assignment" variable="stm_size" value="Default_size"></action>
                                        <action tag="Set stm_pos_y to default" full_name="fullname_21" type="assignment" variable="stm_pos_y" value="Default_PosV"></action>
                                        <action tag="Set stm_rotation to default" full_name="fullname_21" type="assignment" variable="stm_rotation" value="Default_Rotation"></action>
                                        <action tag="If sample from uniform distribution" full_name="fullname_2" type="if" condition="FlagSampUniformDistr == 1">
                                            <action full_name="fullname_6" message="Sample from uniform distribution ..." tag="Report" type="report"></action>
                                            <action tag="Sample stim Pos HR within allowed range" full_name="fullname_10" type="assignment" variable="stm_pos_x" value="initial_PosHR_stair + PosHR_stair_step * disc_rand(1, N_PosHR_stair_current)"></action>
                                        </action>
                                    </action>
                                    <action tag="if Staircase Pos HL" full_name="fullname_16" type="if" condition="(FlagStaircasePosHL == 1 #OR FlagStaircasePosHL == -1) #AND CurrStairTrial == 3">
                                        <action full_name="fullname_6" message="####### Staircase ---> POSITION HORIZONTAL LEFT" tag="Report" type="report"></action>
                                        <action tag="Set Flag_MatchCurrStairTrial to true" full_name="fullname_23" type="assignment" variable="Flag_MatchCurrStairTrial" value="1"></action>
                                        <action tag="Sample stim Pos HL within allowed range" full_name="fullname_10" type="assignment" variable="stm_pos_x" value="initial_PosHL_stair + PosHL_stair_step * (N_PosHL_stair_current - geom_rand(p_GeomDistr_stair_PosHL, N_PosHL_stair_current))"></action>
                                        <action tag="Compute stim Pos HL current range limit" full_name="fullname_10" type="assignment" variable="current_PosHL_limit_stair" value="initial_PosHL_stair + PosHL_stair_step * N_PosHL_stair_current"></action>
                                        <action tag="Set stm_size to default" full_name="fullname_21" type="assignment" variable="stm_size" value="Default_size"></action>
                                        <action tag="Set stm_pos_y to default" full_name="fullname_21" type="assignment" variable="stm_pos_y" value="Default_PosV"></action>
                                        <action tag="Set stm_rotation to default" full_name="fullname_21" type="assignment" variable="stm_rotation" value="Default_Rotation"></action>
                                        <action tag="If sample from uniform distribution" full_name="fullname_2" type="if" condition="FlagSampUniformDistr == 1">
                                            <action full_name="fullname_6" message="Sample from uniform distribution ..." tag="Report" type="report"></action>
                                            <action tag="Sample stim Pos HL within allowed range" full_name="fullname_10" type="assignment" variable="stm_pos_x" value="initial_PosHL_stair + PosHL_stair_step * disc_rand(1, N_PosHL_stair_current)"></action>
                                        </action>
                                    </action>
                                    <action tag="if Staircase Pos VU" full_name="fullname_16" type="if" condition="(FlagStaircasePosVU == 1 #OR FlagStaircasePosVU == -1) #AND CurrStairTrial == 4">
                                        <action full_name="fullname_6" message="####### Staircase ---> POSITION VERTICAL UP" tag="Report" type="report"></action>
                                        <action tag="Set Flag_MatchCurrStairTrial to true" full_name="fullname_23" type="assignment" variable="Flag_MatchCurrStairTrial" value="1"></action>
                                        <action tag="Sample stim Pos VU within allowed range" full_name="fullname_10" type="assignment" variable="stm_pos_y" value="initial_PosVU_stair + PosVU_stair_step * (N_PosVU_stair_current - geom_rand(p_GeomDistr_stair_PosVU, N_PosVU_stair_current))"></action>
                                        <action tag="Compute stim Pos VU current range limit" full_name="fullname_10" type="assignment" variable="current_PosVU_limit_stair" value="initial_PosVU_stair + PosVU_stair_step * N_PosVU_stair_current"></action>
                                        <action tag="Set stm_size to default" full_name="fullname_21" type="assignment" variable="stm_size" value="Default_size"></action>
                                        <action tag="Set stm_pos_x to default" full_name="fullname_21" type="assignment" variable="stm_pos_x" value="Default_PosH"></action>
                                        <action tag="Set stm_rotation to default" full_name="fullname_21" type="assignment" variable="stm_rotation" value="Default_Rotation"></action>
                                        <action tag="If sample from uniform distribution" full_name="fullname_2" type="if" condition="FlagSampUniformDistr == 1">
                                            <action tag="Sample stim Pos VU within allowed range" full_name="fullname_10" type="assignment" variable="stm_pos_y" value="initial_PosVU_stair + PosVU_stair_step * disc_rand(1, N_PosVU_stair_current)"></action>
                                        </action>
                                    </action>
                                    <action tag="if Staircase Pos VD" full_name="fullname_16" type="if" condition="(FlagStaircasePosVD == 1 #OR FlagStaircasePosVD == -1) #AND CurrStairTrial == 5">
                                        <action full_name="fullname_6" message="####### Staircase ---> POSITION VERTICAL DOWN" tag="Report" type="report"></action>
                                        <action tag="Set Flag_MatchCurrStairTrial to true" full_name="fullname_23" type="assignment" variable="Flag_MatchCurrStairTrial" value="1"></action>
                                        <action tag="Sample stim Pos VD within allowed range" full_name="fullname_10" type="assignment" variable="stm_pos_y" value="initial_PosVD_stair + PosVD_stair_step * (N_PosVD_stair_current - geom_rand(p_GeomDistr_stair_PosVD, N_PosVD_stair_current))"></action>
                                        <action tag="Compute stim Pos VD current range limit" full_name="fullname_10" type="assignment" variable="current_PosVD_limit_stair" value="initial_PosVD_stair + PosVD_stair_step * N_PosVD_stair_current"></action>
                                        <action tag="Set stm_size to default" full_name="fullname_21" type="assignment" variable="stm_size" value="Default_size"></action>
                                        <action tag="Set stm_pos_x to default" full_name="fullname_21" type="assignment" variable="stm_pos_x" value="Default_PosH"></action>
                                        <action tag="Set stm_rotation to default" full_name="fullname_21" type="assignment" variable="stm_rotation" value="Default_Rotation"></action>
                                        <action tag="If sample from uniform distribution" full_name="fullname_2" type="if" condition="FlagSampUniformDistr == 1">
                                            <action tag="Sample stim Pos VD within allowed range" full_name="fullname_10" type="assignment" variable="stm_pos_y" value="initial_PosVD_stair + PosVD_stair_step * disc_rand(1, N_PosVD_stair_current)"></action>
                                        </action>
                                    </action>
                                    <action tag="if Staircase Rot CW" full_name="fullname_16" type="if" condition="(FlagStaircaseRotCW == 1 #OR FlagStaircaseRotCW == -1) #AND CurrStairTrial == 6">
                                        <action full_name="fullname_6" message="####### Staircase ---> ROTATION CLOCKWISE" tag="Report" type="report"></action>
                                        <action tag="Set Flag_MatchCurrStairTrial to true" full_name="fullname_23" type="assignment" variable="Flag_MatchCurrStairTrial" value="1"></action>
                                        <action tag="Sample stim ROT CW within allowed range" full_name="fullname_10" type="assignment" variable="stm_rotation" value="initial_RotCW_stair + RotCW_stair_step * (N_RotCW_stair_current - geom_rand(p_GeomDistr_stair_RotCW, N_RotCW_stair_current))"></action>
                                        <action tag="Compute stim Rot CW current range limit" full_name="fullname_10" type="assignment" variable="current_RotCW_limit_stair" value="initial_RotCW_stair + RotCW_stair_step * N_RotCW_stair_current"></action>
                                        <action tag="Set stm_size to default" full_name="fullname_21" type="assignment" variable="stm_size" value="Default_size_for_StairRotation"></action>
                                        <action tag="Set stm_pos_x to default" full_name="fullname_21" type="assignment" variable="stm_pos_x" value="Default_PosH"></action>
                                        <action tag="Set stm_pos_y to default" full_name="fullname_21" type="assignment" variable="stm_pos_y" value="Default_PosV"></action>
                                        <action tag="If sample from uniform distribution" full_name="fullname_2" type="if" condition="FlagSampUniformDistr == 1">
                                            <action full_name="fullname_6" message="Sample from uniform distribution ..." tag="Report" type="report"></action>
                                            <action tag="Sample stim Rot CW within allowed range" full_name="fullname_10" type="assignment" variable="stm_rotation" value="initial_RotCW_stair + RotCW_stair_step * disc_rand(1, N_RotCW_stair_current)"></action>
                                        </action>
                                    </action>
                                    <action tag="if Staircase Rot ACW" full_name="fullname_16" type="if" condition="(FlagStaircaseRotACW == 1 #OR FlagStaircaseRotACW == -1) #AND CurrStairTrial == 7">
                                        <action full_name="fullname_6" message="####### Staircase ---> ROTATION ANTI-CLOCKWISE" tag="Report" type="report"></action>
                                        <action tag="Set Flag_MatchCurrStairTrial to true" full_name="fullname_23" type="assignment" variable="Flag_MatchCurrStairTrial" value="1"></action>
                                        <action tag="Sample stim ROT ACW within allowed range" full_name="fullname_10" type="assignment" variable="stm_rotation" value="initial_RotACW_stair + RotACW_stair_step * (N_RotACW_stair_current - geom_rand(p_GeomDistr_stair_RotACW, N_RotACW_stair_current))"></action>
                                        <action tag="Compute stim Rot ACW current range limit" full_name="fullname_10" type="assignment" variable="current_RotACW_limit_stair" value="initial_RotACW_stair + RotACW_stair_step * N_RotACW_stair_current"></action>
                                        <action tag="Set stm_size to default" full_name="fullname_21" type="assignment" variable="stm_size" value="Default_size_for_StairRotation"></action>
                                        <action tag="Set stm_pos_x to default" full_name="fullname_21" type="assignment" variable="stm_pos_x" value="Default_PosH"></action>
                                        <action tag="Set stm_pos_y to default" full_name="fullname_21" type="assignment" variable="stm_pos_y" value="Default_PosV"></action>
                                        <action tag="If sample from uniform distribution" full_name="fullname_2" type="if" condition="FlagSampUniformDistr == 1">
                                            <action full_name="fullname_6" message="Sample from uniform distribution ..." tag="Report" type="report"></action>
                                            <action tag="Sample stim Rot ACW within allowed range" full_name="fullname_10" type="assignment" variable="stm_rotation" value="initial_RotACW_stair + RotACW_stair_step * disc_rand(1, N_RotACW_stair_current)"></action>
                                        </action>
                                    </action>
                                    <action type="if" tag="If do not show left stim" condition="FlagShowStimLeft == 0">
                                        <action type="if" tag="if this is the left stimulus" condition="ImageIndex == 1">
                                            <action type="if" tag="If discarding left stimulus is allowed" condition="FlagAlwaysEnforceMaxSeqLeng == 0 #OR (FlagAlwaysEnforceMaxSeqLeng == 1 #AND RightStim_Counter #LT MaxN_IdenticalStims)">
                                                <action full_name="fullname_6" message="Discard left stimulus ..." tag="Report" type="report"></action>
                                                <action tag="set FlagDiscardCurrStim to 1" full_name="fullname_2" type="assignment" variable="FlagDiscardCurrStim" value="1"></action>
                                            </action>
                                        </action>
                                    </action>
                                    <action type="if" tag="If do not show right stim" condition="FlagShowStimRight == 0">
                                        <action type="if" tag="if this is the right stimulus" condition="ImageIndex == 0">
                                            <action type="if" tag="If discarding right stimulus is allowed" condition="FlagAlwaysEnforceMaxSeqLeng == 0 #OR (FlagAlwaysEnforceMaxSeqLeng == 1 #AND LeftStim_Counter #LT MaxN_IdenticalStims)">
                                                <action full_name="fullname_6" message="Discard right stimulus ..." tag="Report" type="report"></action>
                                                <action tag="set FlagDiscardCurrStim to 1" full_name="fullname_2" type="assignment" variable="FlagDiscardCurrStim" value="1"></action>
                                            </action>
                                        </action>
                                    </action>
                                    <action tag="CheckForBlockedTrialTime" full_name="fullname_1" type="start_timer" timer="CheckForBlockedTrialTimer" duration="CheckForBlockedTrialDuration" timebase=""></action>
                                    <transition tag="If too many identical stims in a row" full_name="fullname_13" target="IVP Finish" type="conditional" condition="((FlagShowStimRight == 1 #AND FlagShowStimLeft == 1) #OR FlagAlwaysEnforceMaxSeqLeng == 1) #AND ( (ImageIndex == 0 #AND RightStim_Counter #GE MaxN_IdenticalStims) #OR (ImageIndex == 1 #AND LeftStim_Counter #GE MaxN_IdenticalStims) )"></transition>
                                    <transition tag="if no match with current staircase trial type" full_name="fullname_28" target="IVP Finish" type="conditional" condition="Flag_MatchCurrStairTrial == 0"></transition>
                                    <transition tag="If trial contains NOT allowed stimulus" full_name="fullname_3" target="IVP Finish" type="conditional" condition="FlagDiscardCurrStim == 1"></transition>
                                    <transition tag="If already licking..." full_name="fullname_11" target="IVP Block Trial" type="conditional" condition="LickInput1 #GT 500 #OR LickInput3 #GT 500"></transition>
                                    <transition tag="if Timer Expired..." full_name="fullname_3" target="IVP Wait For Trigger Trial" type="timer_expired" timer="CheckForBlockedTrialTimer"></transition>
                                </task_system_state>
                                <task_system_state tag="IVP Block Trial" full_name="Block Trial" description="Block current trial is rat is licking before the starting tone" interruptible="YES">
                                    <action full_name="fullname_6" message="Block the trial ..." tag="Report" type="report"></action>
                                    <action duration="BlockTrial_time" full_name="fullname_15" tag="Start Block Trial Timer" timer="BlockTrial_timer" type="start_timer" timebase=""></action>
                                    <transition tag="If Timer Expired..." full_name="fullname_18" target="IVP Initialize" type="timer_expired" timer="BlockTrial_timer"></transition>
                                </task_system_state>
                                <task_system_state tag="IVP Wait For Trigger Trial" full_name="fullname_10" description="Initialize the current trial" interruptible="YES">
                                    <action message="Wait for animal triggering the trial ..." tag="Report" type="report" full_name=""></action>
                                    <action tag="Start Wait For Trigger Timer" full_name="fullname_1" type="start_timer" timer="WaitForTrigger_timer" duration="WaitForTrigger_time" timebase=""></action>
                                    <transition tag="If touching trigger port and allowed stimulus" full_name="fullname_11" target="IVP Pre-show stimulus" type="conditional" condition="LickInput2 #GT 500"></transition>
                                    <transition tag="If already licking..." full_name="fullname_11" target="IVP Block Trial" type="conditional" condition="LickInput1 #GT 500 #OR LickInput3 #GT 500"></transition>
                                    <transition tag="if Timer Expired..." full_name="fullname_3" target="IVP Wait For Trigger Trial" type="timer_expired" timer="WaitForTrigger_timer"></transition>
                                </task_system_state>
                                <task_system_state tag="IVP Pre-show stimulus" full_name="fullname_10" description="" interruptible="YES">
                                    <action message="IVP Pre-show stimulus ..." tag="Report" type="report" full_name=""></action>
                                    <action full_name="fullname_14" sound="StartTrialSound" tag="Play cue start trial sound" type="play_sound"></action>
                                    <action tag="Announce start trial" full_name="fullname_10" type="assignment" variable="Announce_TrialStart" value="1"></action>
                                    <action tag="Start wait for trigger tone duration" full_name="fullname_1" type="start_timer" timer="WaitForTriggerToneDuration_timer" duration="WaitForTriggerToneDuration_time" timebase=""></action>
                                    <action type="report" message="SHOULD GO TO IVP Show Stimulus!!!" tag="~ELEMENTNAME~" full_name=""></action>
                                    <transition tag="If Timer Expired" full_name="fullname_13" target="IVP Show Stimulus" type="timer_expired" timer="WaitForTriggerToneDuration_timer"></transition>
                                </task_system_state>
                                <task_system_state tag="IVP Show Stimulus" full_name="fullname_1" description="" interruptible="YES">
                                    <action full_name="fullname_6" message="Triggered stimulus presentation..." tag="Report" type="report"></action>
                                    <action tag="If Shape # 1" full_name="fullname_11" type="if" condition="ImageIndex == 0">
                                        <action tag="Increment right stim counter" full_name="fullname_3" type="assignment" variable="RightStim_Counter" value="RightStim_Counter+1"></action>
                                        <action tag="Initialize to zero left stim counter" full_name="fullname_3" type="assignment" variable="LeftStim_Counter" value="0"></action>
                                        <action tag="If cue stim with a reinforcement sound" full_name="fullname_2" type="if" condition="FlagCueStimSound == 1">
                                            <action full_name="fullname_14" sound="StimRight" tag="Play right stimulus sound" type="play_sound"></action>
                                        </action>
                                        <action tag="If always reward" full_name="fullname_2" type="if" condition="FlagAlwaysReward == 1">
                                            <action full_name="fullname_17" tag="Give Reward" type="assignment" value="cue_reward_duration" variable="LickOutput3"></action>
                                        </action>
                                    </action>
                                    <action tag="If Shape # 2" full_name="fullname_11" type="if" condition="ImageIndex == 1">
                                        <action tag="Increment left stim counter" full_name="fullname_3" type="assignment" variable="LeftStim_Counter" value="LeftStim_Counter+1"></action>
                                        <action tag="Initialize to zero right stim counter" full_name="fullname_3" type="assignment" variable="RightStim_Counter" value="0"></action>
                                        <action tag="If cue stim with a reinforcement sound" full_name="fullname_2" type="if" condition="FlagCueStimSound == 1">
                                            <action full_name="fullname_14" sound="StimLeft" tag="Play left stimulus sound" type="play_sound"></action>
                                        </action>
                                        <action tag="If always reward" full_name="fullname_2" type="if" condition="FlagAlwaysReward == 1">
                                            <action full_name="fullname_17" tag="Give Reward" type="assignment" value="cue_reward_duration" variable="LickOutput1"></action>
                                        </action>
                                    </action>
                                    <action tag="queue background" full_name="queue stm" type="queue_stimulus" stimulus="BlankScreen"></action>
                                    <action tag="queue stm" full_name="queue stm" type="queue_stimulus" stimulus="Stimulus_Set[ImageIndex]"></action>
                                    <action tag="Announce stim on" full_name="fullname_10" type="assignment" variable="Announce_StimOn" value="1"></action>
                                    <action tag="show stm" full_name="show stm" type="update_stimulus_display"></action>
                                    <action duration="StimulusPresentation_time - CueStimSoundPresentation_time" full_name="fullname_15" tag="Start Stim Duration Timer" timer="StimulusPresentation_timer" type="start_timer" timebase=""></action>
                                    <action duration="CueStimSoundPresentation_time" full_name="fullname_15" tag="Start Sound Duration Timer" timer="CueStimSoundPresentation_timer" type="start_timer" timebase=""></action>
                                    <action duration="TooFast_time" full_name="fullname_15" tag="Start TooFast Timer" timer="TooFast_timer" type="start_timer" timebase=""></action>
                                    <transition tag="if Lick Port 1 or 3" full_name="fullname_1" target="IVP Aborted" type="conditional" condition="LickInput1 #GT 500 #OR LickInput3 #GT 500"></transition>
                                    <transition tag="if Too Fast timer expired" full_name="fullname_6" target="IVP Keep playing sound" type="timer_expired" timer="TooFast_timer"></transition>
                                </task_system_state>
                                <task_system_state tag="IVP Keep playing sound" full_name="fullname_1" description="" interruptible="YES">
                                    <action full_name="fullname_6" message="Keep playing sound ..." tag="Report" type="report"></action>
                                    <transition tag="if Lick Port 1" full_name="fullname_1" target="IVP Acquire Port 1" type="conditional" condition="LickInput1 #GT 500"></transition>
                                    <transition tag="if Lick Port 3" full_name="fullname_3" target="IVP Acquire Port 3" type="conditional" condition="LickInput3 #GT 500"></transition>
                                    <transition tag="If Sound Duration Timer Expired" full_name="fullname_15" target="IVP Keep stim ON after cue sound offset" type="timer_expired" timer="CueStimSoundPresentation_timer"></transition>
                                </task_system_state>
                                <task_system_state tag="IVP Keep stim ON after cue sound offset" full_name="fullname_1" description="" interruptible="YES">
                                    <action full_name="fullname_6" message="Keep showing stimulus after sound offset ..." tag="Report" type="report"></action>
                                    <action tag="Stop right stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimRight"></action>
                                    <action tag="Stop left stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimLeft"></action>
                                    <transition tag="if Lick Port 1" full_name="fullname_1" target="IVP Acquire Port 1" type="conditional" condition="LickInput1 #GT 500"></transition>
                                    <transition tag="if Lick Port 3" full_name="fullname_3" target="IVP Acquire Port 3" type="conditional" condition="LickInput3 #GT 500"></transition>
                                    <transition tag="If Timer Expired" full_name="fullname_15" target="IVP Stimulus Off" type="timer_expired" timer="StimulusPresentation_timer"></transition>
                                </task_system_state>
                                <task_system_state tag="IVP Stimulus Off" full_name="fullname_12" description="" interruptible="YES">
                                    <action tag="dequeue stm" full_name="dequeue stm" type="dequeue_stimulus" stimulus="Stimulus_Set[ImageIndex]"></action>
                                    <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                    <action tag="Announce stim off" full_name="fullname_10" type="assignment" variable="Announce_StimOff" value="1"></action>
                                    <action duration="acquire_time - StimulusPresentation_time" full_name="fullname_15" tag="Start Acquire Timer" timer="acquire_timer" type="start_timer" timebase=""></action>
                                    <transition condition="LickInput1 #GT 500" full_name="fullname_25" tag="If Lick Port 1" target="IVP Acquire Port 1" type="conditional"></transition>
                                    <transition tag="if Lick Port 3" full_name="fullname_4" target="IVP Acquire Port 3" type="conditional" condition="LickInput3 #GT 500"></transition>
                                    <transition tag="If Timer Expired" full_name="fullname_1" target="IVP Ignored" type="timer_expired" timer="acquire_timer"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="Acquire State" interruptible="YES" tag="IVP Acquire Port 1">
                                    <action tag="Announce trigger port 1" full_name="fullname_10" type="assignment" variable="Announce_AcquirePort1" value="1"></action>
                                    <action full_name="fullname_6" message="Response Acquired on Port 1 ..." tag="Report" type="report"></action>
                                    <action tag="Stop left stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimLeft"></action>
                                    <action tag="Stop right stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimRight"></action>
                                    <action type="assignment" tag="Set WatchResponseSide to -1 (LEFT port)" variable="WatchResponseSide" value="-1"></action>
                                    <transition tag="Correct Response" full_name="fullname_6" target="IVP Pre-Reward Port 1" type="conditional" condition="ImageIndex == 1"></transition>
                                    <transition tag="Wrong Response" full_name="fullname_7" target="IVP Failure" type="conditional" condition="ImageIndex == 0"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="Acquire State" interruptible="YES" tag="IVP Pre-Reward Port 1">
                                    <action full_name="fullname_6" message="Pre-Reward Port 1 ..." tag="Report" type="report"></action>
                                    <action tag="If don't display stim after response" full_name="fullname_1" type="if" condition="FlagShowStimAfterResponse == 0">
                                        <action tag="dequeue stm" full_name="dequeue stm" type="dequeue_stimulus" stimulus="Stimulus_Set[ImageIndex]"></action>
                                        <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                        <action tag="Announce stim off" full_name="fullname_10" type="assignment" variable="Announce_StimOff" value="1"></action>
                                    </action>
                                    <action tag="Update success" full_name="fullname_6" type="assignment" variable="success" value="1"></action>
                                    <action tag="If stm_size is at the staircase current limit" full_name="fullname_4" type="if" condition="CurrStairTrial == 1 #AND FlagStaircaseSize ==1 #AND stm_size == current_size_limit_stair">
                                        <action tag="Update WatchSuccessStair_size" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_size" value="1"></action>
                                    </action>
                                    <action tag="If stm_pos_x RIGHT is at the staircase current limit" full_name="fullname_4" type="if" condition="CurrStairTrial == 2 #AND FlagStaircasePosHR ==1 #AND stm_pos_x == current_PosHR_limit_stair">
                                        <action tag="Update WatchSuccessStair_PosHR" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_PosHR" value="1"></action>
                                    </action>
                                    <action tag="If stm_pos_x LEFT is at the staircase current limit" full_name="fullname_4" type="if" condition="CurrStairTrial == 3 #AND FlagStaircasePosHL ==1 #AND stm_pos_x == current_PosHL_limit_stair">
                                        <action tag="Update WatchSuccessStair_PosHL" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_PosHL" value="1"></action>
                                    </action>
                                    <action tag="If stm_pos_y UP is at the staircase current limit" full_name="fullname_4" type="if" condition="CurrStairTrial == 4 #AND FlagStaircasePosVU ==1 #AND stm_pos_y == current_PosVU_limit_stair">
                                        <action tag="Update WatchSuccessStair_PosVU" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_PosVU" value="1"></action>
                                    </action>
                                    <action tag="If stm_pos_y DOWN is at the staircase current limit" full_name="fullname_4" type="if" condition="CurrStairTrial == 5 #AND FlagStaircasePosVD ==1 #AND stm_pos_y == current_PosVD_limit_stair">
                                        <action tag="Update WatchSuccessStair_PosVD" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_PosVD" value="1"></action>
                                    </action>
                                    <action tag="If stm_rotation CW is at the staircase current limit" full_name="fullname_4" type="if" condition="CurrStairTrial == 6 #AND FlagStaircaseRotCW ==1 #AND stm_rotation == current_RotCW_limit_stair">
                                        <action tag="Update WatchSuccessStair_RotCW" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_RotCW" value="1"></action>
                                    </action>
                                    <action tag="If stm_rotation ACW is at the staircase current limit" full_name="fullname_4" type="if" condition="CurrStairTrial == 7 #AND FlagStaircaseRotACW ==1 #AND stm_rotation == current_RotACW_limit_stair">
                                        <action tag="Update WatchSuccessStair_RotACW" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_RotACW" value="1"></action>
                                    </action>
                                    <action tag="Update WatchSuccessBias" full_name="fullname_6" type="assignment" variable="WatchSuccessBias" value="1"></action>
                                    <action duration="prestim_time" full_name="fullname_16" tag="Start PreStim Timer" timer="prestim_timer" type="start_timer" timebase=""></action>
                                    <transition full_name="fullname_21" tag="If Timer Expired..." target="IVP Reward Port 1" timer="prestim_timer" type="timer_expired"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="fullname_11" interruptible="YES" tag="IVP Reward Port 1">
                                    <action full_name="fullname_6" message="REWARD!" tag="Report" type="report"></action>
                                    <action tag="If reward more than maximum allowed" full_name="fullname_21" type="if" condition="reward_duration #GT maximal_reward_duration">
                                        <action full_name="fullname_6" message="reset reward to maximum!" tag="Report" type="report"></action>
                                        <action tag="reset reward to maximum" full_name="fullname_20" type="assignment" variable="reward_duration" value="maximal_reward_duration"></action>
                                    </action>
                                    <action tag="Set current reward duration" full_name="fullname_7" type="assignment" variable="curr_reward_duration" value="reward_duration"></action>
                                    <action full_name="fullname_17" tag="Give Reward" type="assignment" value="curr_reward_duration" variable="LickOutput1"></action>
                                    <action full_name="fullname_31" sound="RewardSound" tag="Play Reward Tone" type="play_sound"></action>
                                    <transition full_name="fullname_23" tag="Goto Licking Time" target="IVP Additional Licking Time" type="direct"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="Acquire State" interruptible="YES" tag="IVP Acquire Port 3">
                                    <action tag="Announce trigger port 3" full_name="fullname_10" type="assignment" variable="Announce_AcquirePort3" value="1"></action>
                                    <action full_name="fullname_6" message="Response Acquired on Port 3 ..." tag="Report" type="report"></action>
                                    <action tag="Stop left stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimLeft"></action>
                                    <action tag="Stop right stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimRight"></action>
                                    <action type="assignment" tag="Set WatchResponseSide to 1 (RIGHT port)" variable="WatchResponseSide" value="1"></action>
                                    <transition tag="Correct Response" full_name="fullname_8" target="IVP Pre-Reward Port 3" type="conditional" condition="ImageIndex == 0"></transition>
                                    <transition tag="Wrong Response" full_name="fullname_9" target="IVP Failure" type="conditional" condition="ImageIndex == 1"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="Acquire State" interruptible="YES" tag="IVP Pre-Reward Port 3">
                                    <action full_name="fullname_6" message="Pre-Reward Port 3 ..." tag="Report" type="report"></action>
                                    <action tag="If don't display stim after response" full_name="fullname_1" type="if" condition="FlagShowStimAfterResponse == 0">
                                        <action tag="dequeue stm" full_name="dequeue stm" type="dequeue_stimulus" stimulus="Stimulus_Set[ImageIndex]"></action>
                                        <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                        <action tag="Announce stim off" full_name="fullname_10" type="assignment" variable="Announce_StimOff" value="1"></action>
                                    </action>
                                    <action tag="Update success" full_name="fullname_6" type="assignment" variable="success" value="1"></action>
                                    <action tag="If stm_size is at the staircase current limit" full_name="fullname_4" type="if" condition="CurrStairTrial == 1 #AND FlagStaircaseSize ==1 #AND stm_size == current_size_limit_stair">
                                        <action tag="Update WatchSuccessStair_size" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_size" value="1"></action>
                                    </action>
                                    <action tag="If stm_pos_x RIGHT is at the staircase current limit" full_name="fullname_4" type="if" condition="CurrStairTrial == 2 #AND FlagStaircasePosHR ==1 #AND stm_pos_x == current_PosHR_limit_stair">
                                        <action tag="Update WatchSuccessStair_PosHR" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_PosHR" value="1"></action>
                                    </action>
                                    <action tag="If stm_pos_x LEFT is at the staircase current limit" full_name="fullname_4" type="if" condition="CurrStairTrial == 3 #AND FlagStaircasePosHL ==1 #AND stm_pos_x == current_PosHL_limit_stair">
                                        <action tag="Update WatchSuccessStair_PosHL" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_PosHL" value="1"></action>
                                    </action>
                                    <action tag="If stm_pos_y UP is at the staircase current limit" full_name="fullname_4" type="if" condition="CurrStairTrial == 4 #AND FlagStaircasePosVU ==1 #AND stm_pos_y == current_PosVU_limit_stair">
                                        <action tag="Update WatchSuccessStair_PosVU" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_PosVU" value="1"></action>
                                    </action>
                                    <action tag="If stm_pos_y DOWN is at the staircase current limit" full_name="fullname_4" type="if" condition="CurrStairTrial == 5 #AND FlagStaircasePosVD ==1 #AND stm_pos_y == current_PosVD_limit_stair">
                                        <action tag="Update WatchSuccessStair_PosVD" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_PosVD" value="1"></action>
                                    </action>
                                    <action tag="If stm_rotation CW is at the staircase current limit" full_name="fullname_4" type="if" condition="CurrStairTrial == 6 #AND FlagStaircaseRotCW ==1 #AND stm_rotation == current_RotCW_limit_stair">
                                        <action tag="Update WatchSuccessStair_RotCW" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_RotCW" value="1"></action>
                                    </action>
                                    <action tag="If stm_rotation ACW is at the staircase current limit" full_name="fullname_4" type="if" condition="CurrStairTrial == 7 #AND FlagStaircaseRotACW ==1 #AND stm_rotation == current_RotACW_limit_stair">
                                        <action tag="Update WatchSuccessStair_RotACW" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_RotACW" value="1"></action>
                                    </action>
                                    <action tag="Update WatchSuccessBias" full_name="fullname_6" type="assignment" variable="WatchSuccessBias" value="1"></action>
                                    <action duration="prestim_time" full_name="fullname_16" tag="Start PreStim Timer" timer="prestim_timer" type="start_timer" timebase=""></action>
                                    <transition full_name="fullname_21" tag="If Timer Expired..." target="IVP Reward Port 3" timer="prestim_timer" type="timer_expired"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="fullname_11" interruptible="YES" tag="IVP Reward Port 3">
                                    <action full_name="fullname_6" message="REWARD!" tag="Report" type="report"></action>
                                    <action tag="If reward more than maximum allowed" full_name="fullname_21" type="if" condition="reward_duration #GT maximal_reward_duration">
                                        <action full_name="fullname_6" message="reset reward to maximum!" tag="Report" type="report"></action>
                                        <action tag="reset reward to maximum" full_name="fullname_20" type="assignment" variable="reward_duration" value="maximal_reward_duration"></action>
                                    </action>
                                    <action tag="Set current reward duration" full_name="fullname_7" type="assignment" variable="curr_reward_duration" value="reward_duration"></action>
                                    <action full_name="fullname_17" tag="Give Reward" type="assignment" value="curr_reward_duration" variable="LickOutput3"></action>
                                    <action full_name="fullname_31" sound="RewardSound" tag="Play Reward Tone" type="play_sound"></action>
                                    <transition full_name="fullname_23" tag="Goto Licking Time" target="IVP Additional Licking Time" type="direct"></transition>
                                </task_system_state>
                                <task_system_state tag="IVP Additional Licking Time" full_name="fullname_1" description="" interruptible="YES">
                                    <action full_name="fullname_6" message="Give additional Licking time ..." tag="Report" type="report"></action>
                                    <action tag="If reward less than maximum allowed" full_name="fullname_21" type="if" condition="reward_duration #LT maximal_reward_duration">
                                        <action tag="Increment reward" full_name="fullname_20" type="assignment" variable="reward_duration" value="reward_duration + increment_reward_duration"></action>
                                    </action>
                                    <action duration="licking_time" full_name="fullname_16" tag="Start licking Timer" timer="licking_timer" type="start_timer" timebase=""></action>
                                    <transition tag="If Timer Expired ..." full_name="fullname_5" target="IVP Idle" type="timer_expired" timer="licking_timer"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="fullname_12" interruptible="YES" tag="IVP Failure">
                                    <action full_name="fullname_6" message="Failed..." tag="Report" type="report"></action>
                                    <action tag="Initialize reward to minimum" full_name="fullname_20" type="assignment" variable="reward_duration" value="minimal_reward_duration"></action>
                                    <action tag="Initialize punishment cycle index" full_name="fullname_19" type="assignment" variable="PunishmentCyclesIndex" value="0"></action>
                                    <action full_name="fullname_31" sound="FailureSound2" tag="Play Failure Tone" type="play_sound"></action>
                                    <action tag="Update failure" full_name="fullname_6" type="assignment" variable="failure" value="1"></action>
                                    <action tag="If stm_size is at the staircase current limit" full_name="fullname_4" type="if" condition="CurrStairTrial == 1 #AND FlagStaircaseSize ==1 #AND stm_size == current_size_limit_stair">
                                        <action tag="Update WatchSuccessStair_size" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_size" value="0"></action>
                                    </action>
                                    <action tag="If stm_pos_x RIGHT is at the staircase current limit" full_name="fullname_4" type="if" condition="CurrStairTrial == 2 #AND FlagStaircasePosHR ==1 #AND stm_pos_x == current_PosHR_limit_stair">
                                        <action tag="Update WatchSuccessStair_PosHR" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_PosHR" value="0"></action>
                                    </action>
                                    <action tag="If stm_pos_x LEFT is at the staircase current limit" full_name="fullname_4" type="if" condition="CurrStairTrial == 3 #AND FlagStaircasePosHL ==1 #AND stm_pos_x == current_PosHL_limit_stair">
                                        <action tag="Update WatchSuccessStair_PosHL" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_PosHL" value="0"></action>
                                    </action>
                                    <action tag="If stm_pos_y UP is at the staircase current limit" full_name="fullname_4" type="if" condition="CurrStairTrial == 4 #AND FlagStaircasePosVU ==1 #AND stm_pos_y == current_PosVU_limit_stair">
                                        <action tag="Update WatchSuccessStair_PosVU" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_PosVU" value="0"></action>
                                    </action>
                                    <action tag="If stm_pos_y DOWN is at the staircase current limit" full_name="fullname_4" type="if" condition="CurrStairTrial == 5 #AND FlagStaircasePosVD ==1 #AND stm_pos_y == current_PosVD_limit_stair">
                                        <action tag="Update WatchSuccessStair_PosVD" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_PosVD" value="0"></action>
                                    </action>
                                    <action tag="If stm_rotation CW is at the staircase current limit" full_name="fullname_4" type="if" condition="CurrStairTrial == 6 #AND FlagStaircaseRotCW ==1 #AND stm_rotation == current_RotCW_limit_stair">
                                        <action tag="Update WatchSuccessStair_RotCW" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_RotCW" value="0"></action>
                                    </action>
                                    <action tag="If stm_rotation ACW is at the staircase current limit" full_name="fullname_4" type="if" condition="CurrStairTrial == 7 #AND FlagStaircaseRotACW ==1 #AND stm_rotation == current_RotACW_limit_stair">
                                        <action tag="Update WatchSuccessStair_RotACW" full_name="fullname_6" type="assignment" variable="WatchSuccessStair_RotACW" value="0"></action>
                                    </action>
                                    <action tag="Update WatchSuccessBias" full_name="fullname_6" type="assignment" variable="WatchSuccessBias" value="0"></action>
                                    <action tag="dequeue stm" full_name="dequeue stm" type="dequeue_stimulus" stimulus="Stimulus_Set[ImageIndex]"></action>
                                    <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                    <action tag="Announce stim off" full_name="fullname_10" type="assignment" variable="Announce_StimOff" value="1"></action>
                                    <transition tag="Go into Punishment Loop" full_name="fullname_2" target="IVP Punishment Loop Gray" type="conditional" condition="FlagLongPunishment == 1"></transition>
                                    <transition tag="Goto Idle" full_name="fullname_3" target="IVP Idle" type="conditional" condition="FlagLongPunishment == 0"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="fullname_12" interruptible="YES" tag="IVP Punishment Loop Gray">
                                    <action full_name="fullname_6" message="Failed: punish with gray background" tag="Report" type="report"></action>
                                    <action full_name="fullname_31" sound="FailureSound" tag="Play Failure Tone" type="play_sound"></action>
                                    <action tag="queue gray background" full_name="queue stm" type="queue_stimulus" stimulus="BlankScreenGray"></action>
                                    <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                    <action duration="backgr_punish_flickering_period" full_name="fullname_16" tag="Start gray background Timer" timer="background_timer" type="start_timer" timebase=""></action>
                                    <transition tag="If Timer Expired ..." full_name="fullname_14" target="IVP Punishment Loop Black" type="timer_expired" timer="background_timer"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="fullname_12" interruptible="YES" tag="IVP Punishment Loop Black">
                                    <action full_name="fullname_6" message="Failed: punish with black background" tag="Report" type="report"></action>
                                    <action tag="Update punishment cycle index" full_name="fullname_19" type="assignment" variable="PunishmentCyclesIndex" value="PunishmentCyclesIndex + 1"></action>
                                    <action full_name="fullname_31" sound="FailureSound2" tag="Play Failure Tone" type="play_sound"></action>
                                    <action tag="dequeue gray background" full_name="dequeue stm" type="dequeue_stimulus" stimulus="BlankScreenGray"></action>
                                    <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                    <action duration="backgr_punish_flickering_period" full_name="fullname_16" tag="Start black background Timer" timer="background_timer" type="start_timer" timebase=""></action>
                                    <transition tag="Repeat current trial as correction" full_name="fullname_1" target="IVP Initialize" type="conditional" condition="PunishmentCyclesIndex #GT N_PunishmentCycles #AND FlagCorrectionTrials == 1"></transition>
                                    <transition tag="Exit loop and jump to Idle" full_name="fullname_17" target="IVP Idle" type="conditional" condition="PunishmentCyclesIndex #GT N_PunishmentCycles #AND FlagCorrectionTrials == 0"></transition>
                                    <transition tag="If Timer Expired ..." full_name="fullname_24" target="IVP Punishment Loop Gray" type="timer_expired" timer="background_timer"></transition>
                                </task_system_state>
                                <task_system_state tag="IVP Aborted" full_name="fullname_7" description="" interruptible="YES">
                                    <action full_name="fullname_6" message="Aborted ..." tag="Report" type="report"></action>
                                    <action full_name="fullname_31" sound="FailureSound2" tag="Play Failure Tone" type="play_sound"></action>
                                    <action tag="Initialize reward to minimum" full_name="fullname_20" type="assignment" variable="reward_duration" value="minimal_reward_duration"></action>
                                    <action tag="Stop left stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimLeft"></action>
                                    <action tag="Stop right stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimRight"></action>
                                    <action tag="dequeue stm" full_name="dequeue stm" type="dequeue_stimulus" stimulus="Stimulus_Set[ImageIndex]"></action>
                                    <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                    <action tag="Announce stim off" full_name="fullname_10" type="assignment" variable="Announce_StimOff" value="1"></action>
                                    <transition tag="AlwaysGo to Idle" full_name="fullname_14" target="IVP Idle" type="direct"></transition>
                                </task_system_state>
                                <task_system_state tag="IVP Ignored" full_name="fullname_11" description="" interruptible="YES">
                                    <action full_name="fullname_6" message="Ignored ..." tag="Report" type="report"></action>
                                    <action tag="Update ignored" full_name="fullname_6" type="assignment" variable="ignore" value="1"></action>
                                    <transition tag="AlwaysGo to Idle" full_name="fullname_13" target="IVP Idle" type="direct"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="fullname_13" interruptible="YES" tag="IVP Idle">
                                    <action full_name="fullname_6" message="idling..." tag="Report" type="report"></action>
                                    <action tag="dequeue stm" full_name="dequeue stm" type="dequeue_stimulus" stimulus="Stimulus_Set[ImageIndex]"></action>
                                    <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                    <action tag="Announce stim off" full_name="fullname_10" type="assignment" variable="Announce_StimOff" value="1"></action>
                                    <action tag="Announce end trial" full_name="fullname_10" type="assignment" variable="Announce_TrialEnd" value="1"></action>
                                    <action duration="intertrial_interval" full_name="fullname_19" tag="Start Idle Timer" timer="idle_timer" type="start_timer" timebase=""></action>
                                    <transition full_name="fullname_20" tag="If Timer Expired..." target="IVP Finish" timer="idle_timer" type="timer_expired"></transition>
                                </task_system_state>
                                <task_system_state description="" full_name="fullname_3" interruptible="YES" tag="IVP Finish">
                                    <action full_name="fullname_6" message="Yielding" tag="Report" type="report"></action>
                                    <action type="assignment" tag="Compute the Adjusted_Metric_Correct_Strategy" variable="Adjusted_Metric_Correct_Strategy" value="GainFactorCorrectMetric * Metric_Correct_Strategy"></action>
                                    <action tag="Reset Announce start trial to zero" full_name="fullname_10" type="assignment" variable="Announce_TrialStart" value="0"></action>
                                    <action tag="Reset Announce end trial to zero" full_name="fullname_10" type="assignment" variable="Announce_TrialEnd" value="0"></action>
                                    <action tag="Reset Announce stim on to zero" full_name="fullname_10" type="assignment" variable="Announce_StimOn" value="0"></action>
                                    <action tag="Reset Announce stim off to zero" full_name="fullname_10" type="assignment" variable="Announce_StimOff" value="0"></action>
                                    <action tag="Reset Announce acquire port 1 to zero" full_name="fullname_10" type="assignment" variable="Announce_AcquirePort1" value="0"></action>
                                    <action tag="Reset Announce acquire port 3 to zero" full_name="fullname_10" type="assignment" variable="Announce_AcquirePort3" value="0"></action>
                                    <transition full_name="fullname_5" tag="Yield" type="yield" target="~STATE_REF~"></transition>
                                </task_system_state>
                            </task_system>
                        </range_replicator>
                    </list>
                    <action device="phidget" full_name="fullname_5" tag="StopDeviceIO3" type="stop_device_io"></action>
                    <action device="NE500" full_name="fullname_5" tag="StopDeviceIO4" type="stop_device_io"></action>
                </trial>
            </block>
        </protocol>
        <protocol tag="Test all transformations" full_name="fullname_1" description="" interruptible="YES" selection="sequential" nsamples="1" sampling_method="cycles">
            <block tag="Transformations Test Block" full_name="fullname_2" description="" interruptible="YES" selection="sequential" nsamples="1" sampling_method="cycles">
                <trial tag="Transformations Test Trial" full_name="fullname_3" description="" interruptible="YES" selection="sequential" nsamples="5000" sampling_method="cycles">
                    <action device="phidget" full_name="fullname_4" tag="StartDeviceIO5" type="start_device_io"></action>
                    <action device="NE500" full_name="fullname_4" tag="StartDeviceIO6" type="start_device_io"></action>
                    <list tag="TransformationsTestRandomShapesList" full_name="fullname_6" description="Randomly sample a task system in which one of the many possible geometrical shapes is used" interruptible="YES" selection="random_without_replacement" nsamples="1" sampling_method="cycles">
                        <range_replicator tag="Transf Test Loop on Geometrical Shapes" full_name="fullname_8" from="0" to="1" step="1" variable="ImageIndex">
                            <range_replicator tag="Loop on Sizes" full_name="fullname_9" from="20" to="35" step="5" variable="Test_Size">
                                <range_replicator tag="Loop on Positions" full_name="fullname_10" from="-10" to="10" step="5" variable="Test_X_Position">
                                    <range_replicator tag="Loop on Rotations" full_name="fullname_11" from="-45" to="45" step="15" variable="Test_Rotation">
                                        <task_system tag="Transf Test Task" full_name="fullname_12" description="" interruptible="YES">
                                            <task_system_state tag="IVP Initialize" full_name="fullname_10" description="Initialize the current trial" interruptible="YES">
                                                <action full_name="fullname_6" message="Initialize IVP trial ..." tag="Report" type="report"></action>
                                                <action tag="Initialize FlagNoFeedbackInCurrentTrial to zero" full_name="fullname_41" type="assignment" variable="FlagNoFeedbackInCurrentTrial" value="0"></action>
                                                <action tag="Assign Size" full_name="fullname_41" type="assignment" variable="stm_size" value="Test_Size"></action>
                                                <action tag="Assign X Position" full_name="fullname_41" type="assignment" variable="stm_pos_x" value="Test_X_Position"></action>
                                                <action tag="Set stm_pos_y to default" full_name="fullname_21" type="assignment" variable="stm_pos_y" value="Default_PosV"></action>
                                                <action tag="Assign Rotation" full_name="fullname_41" type="assignment" variable="stm_rotation" value="Test_Rotation"></action>
                                                <action full_name="fullname_6" message="##### CURRENT STIMULUS: Size = $stm_size" tag="Report" type="report"></action>
                                                <action full_name="fullname_6" message="##### CURRENT STIMULUS: X Position = $stm_pos_x" tag="Report" type="report"></action>
                                                <action full_name="fullname_6" message="##### CURRENT STIMULUS: Rotation = $stm_rotation" tag="Report" type="report"></action>
                                                <action tag="If this is the no feedback transformation 1" full_name="fullname_77" type="if" condition="(stm_size == reject_size1 #AND stm_pos_x == reject_pos_x1 #AND stm_rotation == reject_rot1)">
                                                    <action tag="Set FlagNoFeedbackInCurrentTrial flag to 1" full_name="fullname_41" type="assignment" variable="FlagNoFeedbackInCurrentTrial" value="1"></action>
                                                </action>
                                                <action tag="If this is the no feedback transformation 2" full_name="fullname_77" type="if" condition="(stm_size == reject_size2 #AND stm_pos_x == reject_pos_x2 #AND stm_rotation == reject_rot2)">
                                                    <action tag="Set FlagNoFeedbackInCurrentTrial flag to 1" full_name="fullname_41" type="assignment" variable="FlagNoFeedbackInCurrentTrial" value="1"></action>
                                                </action>
                                                <action tag="If this is the no feedback transformation 3" full_name="fullname_77" type="if" condition="(stm_size == reject_size3 #AND stm_pos_x == reject_pos_x3 #AND stm_rotation == reject_rot3)">
                                                    <action tag="Set FlagNoFeedbackInCurrentTrial flag to 1" full_name="fullname_41" type="assignment" variable="FlagNoFeedbackInCurrentTrial" value="1"></action>
                                                </action>
                                                <action tag="If this is the no feedback transformation 4" full_name="fullname_77" type="if" condition="(stm_size == reject_size4 #AND stm_pos_x == reject_pos_x4 #AND stm_rotation == reject_rot4)">
                                                    <action tag="Set FlagNoFeedbackInCurrentTrial flag to 1" full_name="fullname_41" type="assignment" variable="FlagNoFeedbackInCurrentTrial" value="1"></action>
                                                </action>
                                                <action tag="If this is the no feedback transformation 5" full_name="fullname_77" type="if" condition="(stm_size == reject_size5 #AND stm_pos_x == reject_pos_x5 #AND stm_rotation == reject_rot5)">
                                                    <action tag="Set FlagNoFeedbackInCurrentTrial flag to 1" full_name="fullname_41" type="assignment" variable="FlagNoFeedbackInCurrentTrial" value="1"></action>
                                                </action>
                                                <action tag="If this is one of the new no-feedback transf" full_name="fullname_6" type="if" condition="stm_rotation == 45 #OR stm_rotation == -45">
                                                    <action tag="Set FlagNoFeedbackInCurrentTrial flag to 1" full_name="fullname_41" type="assignment" variable="FlagNoFeedbackInCurrentTrial" value="1"></action>
                                                </action>
                                                <action tag="If this is a no feedback trial" full_name="fullname_94" type="if" condition="FlagNoFeedbackInCurrentTrial == 1">
                                                    <action full_name="fullname_6" message="@@@@@@@@@@@@@@@@@@@@@@@@@@@" tag="Report" type="report"></action>
                                                    <action full_name="fullname_6" message="@@@@@@@@ ATTENTION! @@@@@@@@" tag="Report" type="report"></action>
                                                    <action full_name="fullname_6" message="@@@@@@ NO FEEDBACK TRIAL! @@@@@@" tag="Report" type="report"></action>
                                                    <action full_name="fullname_6" message="@@@@@@@@@@@@@@@@@@@@@@@@@@@" tag="Report" type="report"></action>
                                                </action>
                                                <action tag="CheckForBlockedTrialTime" full_name="fullname_1" type="start_timer" timer="CheckForBlockedTrialTimer" duration="CheckForBlockedTrialDuration" timebase=""></action>
                                                <transition tag="if this is not one of the transformations to test" full_name="fullname_1" target="Reject current transformation not to be tested" type="conditional" condition="(stm_rotation == 45 #OR stm_rotation == -45) #AND ( stm_size == 20 #OR (stm_size == 25 #AND (stm_pos_x == 10 #OR stm_pos_x == -10)) #OR (stm_size == 30 #AND stm_rotation == 45) #OR (stm_size == 35 #AND stm_rotation == -45) )"></transition>
                                                <transition tag="If too many identical stims in a row" full_name="fullname_13" target="Reject Current Trial" type="conditional" condition="FlagShowStimRight == 1 #AND FlagShowStimLeft == 1 #AND ( (ImageIndex == 0 #AND RightStim_Counter #GE MaxN_IdenticalStims) #OR (ImageIndex == 1 #AND LeftStim_Counter #GE MaxN_IdenticalStims) )"></transition>
                                                <transition tag="If trial contains NOT allowed stimulus" full_name="fullname_3" target="Reject Current Trial" type="conditional" condition="((FlagShowStimRight == 0 #AND ImageIndex == 0) #OR (FlagShowStimLeft == 0 #AND ImageIndex == 1))"></transition>
                                                <transition tag="If already licking..." full_name="fullname_11" target="IVP Block Trial" type="conditional" condition="LickInput1 #GT 500 #OR LickInput3 #GT 500"></transition>
                                                <transition tag="if Timer Expired..." full_name="fullname_3" target="IVP Wait For Trigger Trial" type="timer_expired" timer="CheckForBlockedTrialTimer"></transition>
                                            </task_system_state>
                                            <task_system_state tag="IVP Block Trial" full_name="Block Trial" description="Block current trial is rat is licking before the starting tone" interruptible="YES">
                                                <action full_name="fullname_6" message="Block the trial ..." tag="Report" type="report"></action>
                                                <action duration="BlockTrial_time" full_name="fullname_15" tag="Start Block Trial Timer" timer="BlockTrial_timer" type="start_timer" timebase=""></action>
                                                <transition tag="If Timer Expired..." full_name="fullname_18" target="IVP Initialize" type="timer_expired" timer="BlockTrial_timer"></transition>
                                            </task_system_state>
                                            <task_system_state tag="IVP Wait For Trigger Trial" full_name="fullname_10" description="Initialize the current trial" interruptible="YES">
                                                <action full_name="fullname_6" message="Wait for animal triggering the trial ..." tag="Report" type="report"></action>
                                                <action tag="Start Wait For Trigger Timer" full_name="fullname_1" type="start_timer" timer="WaitForTrigger_timer" duration="WaitForTrigger_time" timebase=""></action>
                                                <transition tag="If touching trigger port and allowed stimulus" full_name="fullname_11" target="IVP Pre-show stimulus" type="conditional" condition="LickInput2 #GT 500"></transition>
                                                <transition tag="If already licking..." full_name="fullname_11" target="IVP Block Trial" type="conditional" condition="LickInput1 #GT 500 #OR LickInput3 #GT 500"></transition>
                                                <transition tag="if Timer Expired..." full_name="fullname_3" target="IVP Wait For Trigger Trial" type="timer_expired" timer="WaitForTrigger_timer"></transition>
                                            </task_system_state>
                                            <task_system_state tag="IVP Pre-show stimulus" full_name="fullname_10" description="" interruptible="YES">
                                                <action full_name="fullname_14" sound="StartTrialSound" tag="Play cue start trial sound" type="play_sound"></action>
                                                <action tag="Announce start trial" full_name="fullname_10" type="assignment" variable="Announce_TrialStart" value="1"></action>
                                                <action tag="Start wait for trigger tone duration" full_name="fullname_1" type="start_timer" timer="WaitForTriggerToneDuration_timer" duration="WaitForTriggerToneDuration_time" timebase=""></action>
                                                <transition tag="If Timer Expired" full_name="fullname_13" target="IVP Show Stimulus" type="timer_expired" timer="WaitForTriggerToneDuration_timer"></transition>
                                            </task_system_state>
                                            <task_system_state tag="IVP Show Stimulus" full_name="fullname_1" description="" interruptible="YES">
                                                <action full_name="fullname_6" message="Triggered stimulus presentation..." tag="Report" type="report"></action>
                                                <action tag="If Shape # 1" full_name="fullname_11" type="if" condition="ImageIndex == 0">
                                                    <action tag="Increment right stim counter" full_name="fullname_3" type="assignment" variable="RightStim_Counter" value="RightStim_Counter+1"></action>
                                                    <action tag="Initialize to zero left stim counter" full_name="fullname_3" type="assignment" variable="LeftStim_Counter" value="0"></action>
                                                    <action tag="If cue stim with a reinforcement sound" full_name="fullname_2" type="if" condition="FlagCueStimSound == 1 #AND FlagNoFeedbackInCurrentTrial == 0">
                                                        <action full_name="fullname_14" sound="StimRight" tag="Play right stimulus sound" type="play_sound"></action>
                                                    </action>
                                                    <action tag="If always reward" full_name="fullname_2" type="if" condition="FlagAlwaysReward == 1">
                                                        <action full_name="fullname_17" tag="Give Reward" type="assignment" value="cue_reward_duration" variable="LickOutput3"></action>
                                                    </action>
                                                </action>
                                                <action tag="If Shape # 2" full_name="fullname_11" type="if" condition="ImageIndex == 1">
                                                    <action tag="Increment left stim counter" full_name="fullname_3" type="assignment" variable="LeftStim_Counter" value="LeftStim_Counter+1"></action>
                                                    <action tag="Initialize to zero right stim counter" full_name="fullname_3" type="assignment" variable="RightStim_Counter" value="0"></action>
                                                    <action tag="If cue stim with a reinforcement sound" full_name="fullname_2" type="if" condition="FlagCueStimSound == 1 #AND FlagNoFeedbackInCurrentTrial == 0">
                                                        <action full_name="fullname_14" sound="StimLeft" tag="Play left stimulus sound" type="play_sound"></action>
                                                    </action>
                                                    <action tag="If always reward" full_name="fullname_2" type="if" condition="FlagAlwaysReward == 1">
                                                        <action full_name="fullname_17" tag="Give Reward" type="assignment" value="cue_reward_duration" variable="LickOutput1"></action>
                                                    </action>
                                                </action>
                                                <action tag="queue background" full_name="queue stm" type="queue_stimulus" stimulus="BlankScreen"></action>
                                                <action tag="queue stm" full_name="queue stm" type="queue_stimulus" stimulus="Geometrical_Shape[ImageIndex]"></action>
                                                <action tag="Announce stim on" full_name="fullname_10" type="assignment" variable="Announce_StimOn" value="1"></action>
                                                <action tag="show stm" full_name="show stm" type="update_stimulus_display"></action>
                                                <action duration="StimulusPresentation_time - CueStimSoundPresentation_time" full_name="fullname_15" tag="Start Stim Duration Timer" timer="StimulusPresentation_timer" type="start_timer" timebase=""></action>
                                                <action duration="CueStimSoundPresentation_time" full_name="fullname_15" tag="Start Sound Duration Timer" timer="CueStimSoundPresentation_timer" type="start_timer" timebase=""></action>
                                                <action duration="TooFast_time" full_name="fullname_15" tag="Start TooFast Timer" timer="TooFast_timer" type="start_timer" timebase=""></action>
                                                <transition tag="if Lick Port 1 or 3" full_name="fullname_1" target="IVP Aborted" type="conditional" condition="LickInput1 #GT 500 #OR LickInput3 #GT 500"></transition>
                                                <transition tag="if Too Fast timer expired" full_name="fullname_6" target="IVP Keep playing sound" type="timer_expired" timer="TooFast_timer"></transition>
                                            </task_system_state>
                                            <task_system_state tag="IVP Keep playing sound" full_name="fullname_1" description="" interruptible="YES">
                                                <action full_name="fullname_6" message="Keep playing sound ..." tag="Report" type="report"></action>
                                                <transition tag="if Lick Port 1" full_name="fullname_1" target="IVP Acquire Port 1" type="conditional" condition="LickInput1 #GT 500"></transition>
                                                <transition tag="if Lick Port 3" full_name="fullname_3" target="IVP Acquire Port 3" type="conditional" condition="LickInput3 #GT 500"></transition>
                                                <transition tag="If Sound Duration Timer Expired" full_name="fullname_15" target="IVP Keep stim ON after cue sound offset" type="timer_expired" timer="CueStimSoundPresentation_timer"></transition>
                                            </task_system_state>
                                            <task_system_state tag="IVP Keep stim ON after cue sound offset" full_name="fullname_1" description="" interruptible="YES">
                                                <action full_name="fullname_6" message="Keep showing stimulus after sound offset ..." tag="Report" type="report"></action>
                                                <action tag="Stop right stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimRight"></action>
                                                <action tag="Stop left stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimLeft"></action>
                                                <transition tag="if Lick Port 1" full_name="fullname_1" target="IVP Acquire Port 1" type="conditional" condition="LickInput1 #GT 500"></transition>
                                                <transition tag="if Lick Port 3" full_name="fullname_3" target="IVP Acquire Port 3" type="conditional" condition="LickInput3 #GT 500"></transition>
                                                <transition tag="If Timer Expired" full_name="fullname_15" target="IVP Stimulus Off" type="timer_expired" timer="StimulusPresentation_timer"></transition>
                                            </task_system_state>
                                            <task_system_state tag="IVP Stimulus Off" full_name="fullname_12" description="" interruptible="YES">
                                                <action tag="dequeue stm" full_name="dequeue stm" type="dequeue_stimulus" stimulus="Geometrical_Shape[ImageIndex]"></action>
                                                <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                                <action tag="Announce stim off" full_name="fullname_10" type="assignment" variable="Announce_StimOff" value="1"></action>
                                                <action duration="acquire_time - StimulusPresentation_time" full_name="fullname_15" tag="Start Acquire Timer" timer="acquire_timer" type="start_timer" timebase=""></action>
                                                <transition condition="LickInput1 #GT 500" full_name="fullname_25" tag="If Lick Port 1" target="IVP Acquire Port 1" type="conditional"></transition>
                                                <transition tag="if Lick Port 3" full_name="fullname_4" target="IVP Acquire Port 3" type="conditional" condition="LickInput3 #GT 500"></transition>
                                                <transition tag="If Timer Expired" full_name="fullname_1" target="IVP Ignored" type="timer_expired" timer="acquire_timer"></transition>
                                            </task_system_state>
                                            <task_system_state description="" full_name="Acquire State" interruptible="YES" tag="IVP Acquire Port 1">
                                                <action tag="Announce trigger port 1" full_name="fullname_10" type="assignment" variable="Announce_AcquirePort1" value="1"></action>
                                                <action full_name="fullname_6" message="Response Acquired on Port 1 ..." tag="Report" type="report"></action>
                                                <action tag="Stop left stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimLeft"></action>
                                                <action tag="Stop right stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimRight"></action>
                                                <transition tag="Correct Response but not feedback" full_name="fullname_62" target="Correct No feedback" type="conditional" condition="ImageIndex == 1 #AND FlagNoFeedbackInCurrentTrial == 1"></transition>
                                                <transition tag="Correct Response" full_name="fullname_6" target="IVP Pre-Reward Port 1" type="conditional" condition="ImageIndex == 1 #AND FlagNoFeedbackInCurrentTrial == 0"></transition>
                                                <transition tag="Wrong Response but no feedback" full_name="fullname_89" target="Wrong No feedback" type="conditional" condition="ImageIndex == 0 #AND FlagNoFeedbackInCurrentTrial == 1"></transition>
                                                <transition tag="Wrong Response" full_name="fullname_7" target="IVP Failure" type="conditional" condition="ImageIndex == 0 #AND FlagNoFeedbackInCurrentTrial == 0"></transition>
                                            </task_system_state>
                                            <task_system_state description="" full_name="Acquire State" interruptible="YES" tag="IVP Pre-Reward Port 1">
                                                <action full_name="fullname_6" message="Pre-Reward Port 1 ..." tag="Report" type="report"></action>
                                                <action tag="If don't display stim after response" full_name="fullname_1" type="if" condition="FlagShowStimAfterResponse == 0">
                                                    <action tag="dequeue stm" full_name="dequeue stm" type="dequeue_stimulus" stimulus="Geometrical_Shape[ImageIndex]"></action>
                                                    <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                                    <action tag="Announce stim off" full_name="fullname_10" type="assignment" variable="Announce_StimOff" value="1"></action>
                                                </action>
                                                <action tag="Update success" full_name="fullname_6" type="assignment" variable="success" value="1"></action>
                                                <action duration="prestim_time" full_name="fullname_16" tag="Start PreStim Timer" timer="prestim_timer" type="start_timer" timebase=""></action>
                                                <transition full_name="fullname_21" tag="If Timer Expired..." target="IVP Reward Port 1" timer="prestim_timer" type="timer_expired"></transition>
                                            </task_system_state>
                                            <task_system_state description="" full_name="fullname_11" interruptible="YES" tag="IVP Reward Port 1">
                                                <action full_name="fullname_6" message="REWARD!" tag="Report" type="report"></action>
                                                <action full_name="fullname_17" tag="Give Reward" type="assignment" value="reward_duration" variable="LickOutput1"></action>
                                                <action full_name="fullname_31" sound="RewardSound" tag="Play Reward Tone" type="play_sound"></action>
                                                <transition full_name="fullname_23" tag="Goto Licking Time" target="IVP Additional Licking Time" type="direct"></transition>
                                            </task_system_state>
                                            <task_system_state description="" full_name="Acquire State" interruptible="YES" tag="IVP Acquire Port 3">
                                                <action tag="Announce trigger port 3" full_name="fullname_10" type="assignment" variable="Announce_AcquirePort3" value="1"></action>
                                                <action full_name="fullname_6" message="Response Acquired on Port 3 ..." tag="Report" type="report"></action>
                                                <action tag="Stop left stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimLeft"></action>
                                                <action tag="Stop right stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimRight"></action>
                                                <transition tag="Correct Response but no feedback" full_name="fullname_90" target="Correct No feedback" type="conditional" condition="ImageIndex == 0 #AND FlagNoFeedbackInCurrentTrial == 1"></transition>
                                                <transition tag="Correct Response" full_name="fullname_8" target="IVP Pre-Reward Port 3" type="conditional" condition="ImageIndex == 0 #AND FlagNoFeedbackInCurrentTrial == 0"></transition>
                                                <transition tag="Wrong Response but no feedback" full_name="fullname_91" target="Wrong No feedback" type="conditional" condition="ImageIndex == 1 #AND FlagNoFeedbackInCurrentTrial == 1"></transition>
                                                <transition tag="Wrong Response" full_name="fullname_9" target="IVP Failure" type="conditional" condition="ImageIndex == 1 #AND FlagNoFeedbackInCurrentTrial == 0"></transition>
                                            </task_system_state>
                                            <task_system_state description="" full_name="Acquire State" interruptible="YES" tag="IVP Pre-Reward Port 3">
                                                <action full_name="fullname_6" message="Pre-Reward Port 3 ..." tag="Report" type="report"></action>
                                                <action tag="If don't display stim after response" full_name="fullname_1" type="if" condition="FlagShowStimAfterResponse == 0">
                                                    <action tag="dequeue stm" full_name="dequeue stm" type="dequeue_stimulus" stimulus="Geometrical_Shape[ImageIndex]"></action>
                                                    <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                                    <action tag="Announce stim off" full_name="fullname_10" type="assignment" variable="Announce_StimOff" value="1"></action>
                                                </action>
                                                <action tag="Update success" full_name="fullname_6" type="assignment" variable="success" value="1"></action>
                                                <action duration="prestim_time" full_name="fullname_16" tag="Start PreStim Timer" timer="prestim_timer" type="start_timer" timebase=""></action>
                                                <transition full_name="fullname_21" tag="If Timer Expired..." target="IVP Reward Port 3" timer="prestim_timer" type="timer_expired"></transition>
                                            </task_system_state>
                                            <task_system_state description="" full_name="fullname_11" interruptible="YES" tag="IVP Reward Port 3">
                                                <action full_name="fullname_6" message="REWARD!" tag="Report" type="report"></action>
                                                <action full_name="fullname_17" tag="Give Reward" type="assignment" value="reward_duration" variable="LickOutput3"></action>
                                                <action full_name="fullname_31" sound="RewardSound" tag="Play Reward Tone" type="play_sound"></action>
                                                <transition full_name="fullname_23" tag="Goto Licking Time" target="IVP Additional Licking Time" type="direct"></transition>
                                            </task_system_state>
                                            <task_system_state tag="IVP Additional Licking Time" full_name="fullname_1" description="" interruptible="YES">
                                                <action full_name="fullname_6" message="Give additional Licking time ..." tag="Report" type="report"></action>
                                                <action tag="Accept Current Selection" full_name="fullname_49" type="accept_selections" selection="TransformationsTestRandomShapesList"></action>
                                                <action tag="If reward less than maximum allowed" full_name="fullname_21" type="if" condition="reward_duration #LT maximal_reward_duration">
                                                    <action tag="Increment reward" full_name="fullname_20" type="assignment" variable="reward_duration" value="reward_duration + increment_reward_duration"></action>
                                                </action>
                                                <action duration="licking_time" full_name="fullname_16" tag="Start licking Timer" timer="licking_timer" type="start_timer" timebase=""></action>
                                                <transition tag="If Timer Expired ..." full_name="fullname_5" target="IVP Idle" type="timer_expired" timer="licking_timer"></transition>
                                            </task_system_state>
                                            <task_system_state description="" full_name="fullname_12" interruptible="YES" tag="IVP Failure">
                                                <action full_name="fullname_6" message="Failed..." tag="Report" type="report"></action>
                                                <action tag="Accept Current Selection" full_name="fullname_49" type="accept_selections" selection="TransformationsTestRandomShapesList"></action>
                                                <action tag="Initialize reward to minimum" full_name="fullname_20" type="assignment" variable="reward_duration" value="minimal_reward_duration"></action>
                                                <action tag="Initialize punishment cycle index" full_name="fullname_19" type="assignment" variable="PunishmentCyclesIndex" value="0"></action>
                                                <action full_name="fullname_31" sound="FailureSound2" tag="Play Failure Tone" type="play_sound"></action>
                                                <action tag="Update failure" full_name="fullname_6" type="assignment" variable="failure" value="1"></action>
                                                <action tag="dequeue stm" full_name="dequeue stm" type="dequeue_stimulus" stimulus="Geometrical_Shape[ImageIndex]"></action>
                                                <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                                <action tag="Announce stim off" full_name="fullname_10" type="assignment" variable="Announce_StimOff" value="1"></action>
                                                <transition tag="Go into Punishment Loop" full_name="fullname_2" target="IVP Punishment Loop Gray" type="conditional" condition="FlagLongPunishment == 1"></transition>
                                                <transition tag="Goto Idle" full_name="fullname_3" target="IVP Idle" type="conditional" condition="FlagLongPunishment == 0"></transition>
                                            </task_system_state>
                                            <task_system_state description="" full_name="fullname_12" interruptible="YES" tag="IVP Punishment Loop Gray">
                                                <action full_name="fullname_6" message="Failed: punish with gray background" tag="Report" type="report"></action>
                                                <action full_name="fullname_31" sound="FailureSound" tag="Play Failure Tone" type="play_sound"></action>
                                                <action tag="queue gray background" full_name="queue stm" type="queue_stimulus" stimulus="BlankScreenGray"></action>
                                                <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                                <action duration="backgr_punish_flickering_period" full_name="fullname_16" tag="Start gray background Timer" timer="background_timer" type="start_timer" timebase=""></action>
                                                <transition tag="If Timer Expired ..." full_name="fullname_14" target="IVP Punishment Loop Black" type="timer_expired" timer="background_timer"></transition>
                                            </task_system_state>
                                            <task_system_state description="" full_name="fullname_12" interruptible="YES" tag="IVP Punishment Loop Black">
                                                <action full_name="fullname_6" message="Failed: punish with black background" tag="Report" type="report"></action>
                                                <action tag="Update punishment cycle index" full_name="fullname_19" type="assignment" variable="PunishmentCyclesIndex" value="PunishmentCyclesIndex + 1"></action>
                                                <action full_name="fullname_31" sound="FailureSound2" tag="Play Failure Tone" type="play_sound"></action>
                                                <action tag="dequeue gray background" full_name="dequeue stm" type="dequeue_stimulus" stimulus="BlankScreenGray"></action>
                                                <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                                <action duration="backgr_punish_flickering_period" full_name="fullname_16" tag="Start black background Timer" timer="background_timer" type="start_timer" timebase=""></action>
                                                <transition tag="Repeat current trial as correction" full_name="fullname_1" target="IVP Initialize" type="conditional" condition="PunishmentCyclesIndex #GT N_PunishmentCycles #AND FlagCorrectionTrials == 1"></transition>
                                                <transition tag="Exit loop and jump to Idle" full_name="fullname_17" target="IVP Idle" type="conditional" condition="PunishmentCyclesIndex #GT N_PunishmentCycles #AND FlagCorrectionTrials == 0"></transition>
                                                <transition tag="If Timer Expired ..." full_name="fullname_24" target="IVP Punishment Loop Gray" type="timer_expired" timer="background_timer"></transition>
                                            </task_system_state>
                                            <task_system_state tag="IVP Aborted" full_name="fullname_7" description="" interruptible="YES">
                                                <action full_name="fullname_6" message="Aborted ..." tag="Report" type="report"></action>
                                                <action tag="Reject Current Selection" full_name="fullname_50" type="reject_selections" selection="TransformationsTestRandomShapesList"></action>
                                                <action full_name="fullname_31" sound="FailureSound2" tag="Play Failure Tone" type="play_sound"></action>
                                                <action tag="Initialize reward to minimum" full_name="fullname_20" type="assignment" variable="reward_duration" value="minimal_reward_duration"></action>
                                                <action tag="Stop left stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimLeft"></action>
                                                <action tag="Stop right stimulus sound" full_name="fullname_6" type="stop_sound" sound="StimRight"></action>
                                                <action tag="dequeue stm" full_name="dequeue stm" type="dequeue_stimulus" stimulus="Geometrical_Shape[ImageIndex]"></action>
                                                <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                                <action tag="Announce stim off" full_name="fullname_10" type="assignment" variable="Announce_StimOff" value="1"></action>
                                                <transition tag="AlwaysGo to Idle" full_name="fullname_14" target="IVP Idle" type="direct"></transition>
                                            </task_system_state>
                                            <task_system_state tag="IVP Ignored" full_name="fullname_11" description="" interruptible="YES">
                                                <action full_name="fullname_6" message="Ignored ..." tag="Report" type="report"></action>
                                                <action tag="Reject Current Selection" full_name="fullname_50" type="reject_selections" selection="TransformationsTestRandomShapesList"></action>
                                                <action tag="Update ignored" full_name="fullname_6" type="assignment" variable="ignore" value="1"></action>
                                                <transition tag="AlwaysGo to Idle" full_name="fullname_13" target="IVP Idle" type="direct"></transition>
                                            </task_system_state>
                                            <task_system_state description="" full_name="fullname_13" interruptible="YES" tag="IVP Idle">
                                                <action full_name="fullname_6" message="idling..." tag="Report" type="report"></action>
                                                <action tag="dequeue stm" full_name="dequeue stm" type="dequeue_stimulus" stimulus="Geometrical_Shape[ImageIndex]"></action>
                                                <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                                <action tag="Announce stim off" full_name="fullname_10" type="assignment" variable="Announce_StimOff" value="1"></action>
                                                <action tag="Announce end trial" full_name="fullname_10" type="assignment" variable="Announce_TrialEnd" value="1"></action>
                                                <action duration="intertrial_interval" full_name="fullname_19" tag="Start Idle Timer" timer="idle_timer" type="start_timer" timebase=""></action>
                                                <transition full_name="fullname_20" tag="If Timer Expired..." target="IVP Finish" timer="idle_timer" type="timer_expired"></transition>
                                            </task_system_state>
                                            <task_system_state tag="Reject Current Trial" full_name="fullname_54" description="" interruptible="YES">
                                                <action tag="Reject Current Selection" full_name="fullname_50" type="reject_selections" selection="TransformationsTestRandomShapesList"></action>
                                                <action tag="Increment StimRejections_Counter" full_name="fullname_2" type="assignment" variable="StimRejections_Counter" value="StimRejections_Counter+1"></action>
                                                <action full_name="fullname_6" message="... Reject current trial. Increment rejection counter to $StimRejections_Counter" tag="Report" type="report"></action>
                                                <action tag="If too many rejections" full_name="fullname_3" type="if" condition="StimRejections_Counter #GT MaxN_ConsecutiveRejections">
                                                    <action full_name="fullname_6" message="Too many trial rejections! Initialize to zero all stim presentation counters!" tag="Report" type="report"></action>
                                                    <action tag="Initialize to zero right stim counter" full_name="fullname_3" type="assignment" variable="RightStim_Counter" value="0"></action>
                                                    <action tag="Initialize to zero left stim counter" full_name="fullname_3" type="assignment" variable="LeftStim_Counter" value="0"></action>
                                                    <action tag="Intialize StimRejections_Counter back to zero" full_name="fullname_2" type="assignment" variable="StimRejections_Counter" value="0"></action>
                                                </action>
                                                <transition tag="AlwaysGo to Finish" full_name="fullname_13" target="IVP Finish" type="direct"></transition>
                                            </task_system_state>
                                            <task_system_state tag="Reject current transformation not to be tested" full_name="fullname_2" description="" interruptible="YES">
                                                <action full_name="fullname_6" message="@@@@@@ Transformation NOT to be tested: REJECTED @@@@@@" tag="Report" type="report"></action>
                                                <action tag="Accept Current Selection" full_name="fullname_49" type="accept_selections" selection="TransformationsTestRandomShapesList"></action>
                                                <transition tag="AlwaysGo to Finish" full_name="fullname_13" target="IVP Finish" type="direct"></transition>
                                            </task_system_state>
                                            <task_system_state tag="Correct No feedback" full_name="fullname_59" description="" interruptible="YES">
                                                <action full_name="fullname_6" message="... Correct trial but NOT rewarded (no feedback)" tag="Report" type="report"></action>
                                                <action tag="Announce trial no feedback" full_name="fullname_10" type="assignment" variable="Announce_TrialNoFeedback" value="1"></action>
                                                <action tag="Accept Current Selection" full_name="fullname_49" type="accept_selections" selection="TransformationsTestRandomShapesList"></action>
                                                <action tag="Update success" full_name="fullname_6" type="assignment" variable="success" value="1"></action>
                                                <action tag="dequeue stm" full_name="dequeue stm" type="dequeue_stimulus" stimulus="Geometrical_Shape[ImageIndex]"></action>
                                                <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                                <action tag="Announce stim off" full_name="fullname_10" type="assignment" variable="Announce_StimOff" value="1"></action>
                                                <transition tag="AlwaysGo to Finish" full_name="fullname_93" target="IVP Finish" type="direct"></transition>
                                            </task_system_state>
                                            <task_system_state tag="Wrong No feedback" full_name="fullname_59" description="" interruptible="YES">
                                                <action full_name="fullname_6" message="... Wrong trial but NOT rewarded (no feedback)" tag="Report" type="report"></action>
                                                <action tag="Announce trial no feedback" full_name="fullname_10" type="assignment" variable="Announce_TrialNoFeedback" value="1"></action>
                                                <action tag="Accept Current Selection" full_name="fullname_49" type="accept_selections" selection="TransformationsTestRandomShapesList"></action>
                                                <action tag="Update failure" full_name="fullname_6" type="assignment" variable="failure" value="1"></action>
                                                <action tag="dequeue stm" full_name="dequeue stm" type="dequeue_stimulus" stimulus="Geometrical_Shape[ImageIndex]"></action>
                                                <action tag="refresh display" full_name="refresh display" type="update_stimulus_display"></action>
                                                <action tag="Announce stim off" full_name="fullname_10" type="assignment" variable="Announce_StimOff" value="1"></action>
                                                <transition tag="AlwaysGo to Finish" full_name="fullname_93" target="IVP Finish" type="direct"></transition>
                                            </task_system_state>
                                            <task_system_state description="" full_name="fullname_3" interruptible="YES" tag="IVP Finish">
                                                <action full_name="fullname_6" message="... Yielding" tag="Report" type="report"></action>
                                                <action tag="Reset Announce trial no feedback to zero" full_name="fullname_10" type="assignment" variable="Announce_TrialNoFeedback" value="0"></action>
                                                <action tag="Reset Announce start trial to zero" full_name="fullname_10" type="assignment" variable="Announce_TrialStart" value="0"></action>
                                                <action tag="Reset Announce end trial to zero" full_name="fullname_10" type="assignment" variable="Announce_TrialEnd" value="0"></action>
                                                <action tag="Reset Announce stim on to zero" full_name="fullname_10" type="assignment" variable="Announce_StimOn" value="0"></action>
                                                <action tag="Reset Announce stim off to zero" full_name="fullname_10" type="assignment" variable="Announce_StimOff" value="0"></action>
                                                <action tag="Reset Announce acquire port 1 to zero" full_name="fullname_10" type="assignment" variable="Announce_AcquirePort1" value="0"></action>
                                                <action tag="Reset Announce acquire port 3 to zero" full_name="fullname_10" type="assignment" variable="Announce_AcquirePort3" value="0"></action>
                                                <transition full_name="fullname_5" tag="Yield" type="yield" target="~STATE_REF~"></transition>
                                            </task_system_state>
                                        </task_system>
                                    </range_replicator>
                                </range_replicator>
                            </range_replicator>
                        </range_replicator>
                    </list>
                    <action device="phidget" full_name="fullname_5" tag="StopDeviceIO5" type="stop_device_io"></action>
                    <action device="NE500" full_name="fullname_5" tag="StopDeviceIO6" type="stop_device_io"></action>
                </trial>
            </block>
        </protocol>
    </experiment>
</monkeyml>